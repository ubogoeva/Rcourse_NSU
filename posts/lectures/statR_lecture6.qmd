---
title: "Язык программирования R для анализа данных: лекция 6"
subtitle: 'Введение в статистику вывода'
author: "Elena U"
#date: "Created on 01 April, 2023"
execute:
  echo: true
  output: true
format: 
  revealjs:
    slide-number: c/t
    show-slide-number: all
    # mainfont: Arial
    # fontsize: 14px
    theme: [default, custom.scss]
    chalkboard: 
      buttons: true
    # theme: [serif]
    # mouse-wheel: true
    auto-play-media: true
    width: 1280
    height: 720
    fig-dpi: 300
    # logo: figures/icg.png
revealjs-plugins:
  - pointer
editor: visual
draft: true
---

## Рекомендуемая литература

-   Книги:

    -   "Статистика для всех" Сара Бослаф (Statistics in a Nutshell)

-   Курсы

    -   Введение в статистику (Части [1](https://stepik.org/course/76), [2](https://stepik.org/course/524), [3](https://stepik.org/course/2152)) на платформе Stepik

    -   [Introduction to Probability and Data with R](https://www.coursera.org/learn/probability-intro) на платформе Coursera

::: callout-note
Больше источников [здесь](http://t.me/stats_for_science/28)
:::

## План лекции

-   Типы переменных и типы шкал

-   Понятие генеральной совокупности и выборки

-   Описательные статистики

-   Статистика вывода

-   Тест Стьюдента, ограничения, особенности

## Данные для работы

```{r}
#| include: false
knitr::opts_chunk$set(dpi = 300)
```

```{r}
library(tidyverse)
wc3_units <- read_tsv('https://raw.githubusercontent.com/ubogoeva/tidyverse_tutorial/master/data/wc3_heroes.txt',
                      col_names = TRUE, 
                      na = '-', 
                      name_repair = 'minimal') %>% 
  janitor::clean_names() # для правильных названий колонок

```

## Типы переменных и типы шкал

::: incremental
-   Количественные

    -   Непрерывные (рост, вес, длина корня)

    -   Дискретные (количество детей в семье)

    -   Интервальные (температура в градусах Цельсия)

    -   Ранговые (места в соревнованиях, тяжесть болезни)

-   Качественные (категориальные, номинативные)

    -   Бинарные (есть мутация или нет)
:::

## Классификации типов переменных

Зависимые и независимые переменные - важно для проведения статистических критериев.

## Что такое генеральная совокупность?

::: incremental
-   Генеральная совокупность --- совокупность всех объектов (единиц), относительно которых предполагается делать выводы при изучении конкретной задачи.

-   Генеральная совокупность состоит из всех объектов, которые имеют качества, свойства, интересующие исследователя.

    Например: все клетки определенной клеточной линии, все растения определенного генотипа.
:::

## Что такое выборка?

-   Выборка --- часть генеральной совокупности элементов, доступная для исследования.

    ![](images/image-1460015740.png)

## Классификация выборки

-   По принципу отбора:

    -   Независимые

    -   Зависимые (например до и после применения лекарства)

-   По корректности отбора:

    -   Репрезентативные

    -   Нерепрезентативные

-   Основные стратегии отбора:

    -   Простая случайная выборка

    -   Стратифицированная

## Как можно описать значения в выборке?

Описательные статистики:

-   Меры центральной тенденции

-   Меры изменчивости

## Меры центральной тенденции

-   Среднее - среднее арифметическое всех значений.

-   Медиана - середина упорядоченного ряда значений.

-   Мода - наиболее часто встречающееся значение в выборке.

```{r}
mean(wc3_units$gold) # среднее
mean(wc3_units$gold, na.rm = TRUE) # среднее без учета пропущенных значений
median(wc3_units$gold, na.rm = TRUE) # медиана
```

Для вычисления моды можно использовать функцию `dplyr::count()`

## Вычисление моды: `dplyr::count()`

```{r}
#| output-location: column
wc3_units %>% 
  count(armor_type)
```

```{r}
#| output-location: column
wc3_units %>% 
  count(armor_type) %>% 
  arrange(desc(n))
```

## Меры изменчивости

-   Размах -- разность между максимальным и минимальным значениями.

-   Межквартильный размах -- разница между верхним и нижним квартилем.

-   Дисперсия -- сумма квадратов отклонений, деленная на их количество.

    ::: callout-note
    Отклонение -- это разность между средним арифметическим и конкретным значением.
    :::

-   Стандартное отклонение -- корень из дисперсии.

## Формула дисперсии и стандартного отклонения

Дисперсия (variance):

$$
var = \frac{\sum_{i=1}^n(x_i - \overline{x})^2}{n},
$$

где $\overline{x}$ - среднее, n - количество элементов в выборке

Стандартное отклонение (standard deviation, sd)

$$
sd = \sqrt{var} =\sqrt{\frac{\sum_{i=1}^n(x_i - \overline{x})^2}{n}}
$$

Здесь приведена смещенная оценка - то есть в знаменателе n.

По умолчанию функции `var()` и `sd()` считают несмещенную оценку - в знаменателе n-1.

## Межквартильный размах или как интерпретировать боксплот

Боксплот

![](https://i.ytimg.com/vi/BE8CVGJuftI/maxresdefault.jpg)

## Оценки среднего

Стандартная ошибка

Доверительный интервал

## Нормальное распределение

Непрерывное распределение вероятностей с пиком в центре и симметричными боковыми сторонами, которое в одномерном случае задаётся функцией плотности вероятности, совпадающей с функцией Гаусса.

```{r}
set.seed(1)
norm_distr <- rnorm(10000)
hist(norm_distr, freq = FALSE)
lines(density(norm_distr))

```

## Нормальное распределение

![](https://upload.wikimedia.org/wikipedia/commons/thumb/8/8c/Standard_deviation_diagram.svg/1200px-Standard_deviation_diagram.svg.png){width="522"}

## Центральная предельная теорема

Согласно центральной предельной теореме (ЦПТ, *central limit theorem*), какой бы ни была форма распределения в генеральной совокупности, **выборочное распределение средних** будет стремиться к нормальному. При этом чем больше размер выборки, тем ближе выборочное распределение средних будет к нормальному.

## Центральная предельная теорема

Используем лог-нормальное распределение:

```{r}
hist(rlnorm(10000), breaks = 100)

```

------------------------------------------------------------------------

Как будут распределены средние из лог-нормального распределения?

```{r}
many_means <- replicate(1000, mean(rlnorm(10000)))
hist(many_means, breaks = 100)
```

Они будут распределены нормально!

## Тест Стьюдента

```{r}
wc3_units_armor <- wc3_units %>% 
  filter(armor_type == 'Heavy' | armor_type == 'Light')
t.test(wc3_units_armor$hp ~ wc3_units_armor$armor_type)
```
