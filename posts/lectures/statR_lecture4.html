<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.269">

  <meta name="author" content="Elena U">
  <title>Rcourse_NSU - Язык программирования R для анализа данных: лекция 4</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-pointer/pointer.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  
  <script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Язык программирования R для анализа данных: лекция 4</h1>
  <p class="subtitle">Введение в tidyverse, основные функции dplyr</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Elena U 
</div>
</div>
</div>

  <p class="date">3/7/23</p>
</section>
<section id="цель-занятия" class="slide level2">
<h2>Цель занятия</h2>
<p>Разберем наиболее важные функции <code>tidyverse</code>, в основном из пакета <code>dplyr</code>.</p>
<div class="columns">
<div class="column" style="width:60%;">
<p>Что почитать:</p>
<ul>
<li><p><a href="https://r4ds.had.co.nz/index.html">R4DataScience</a> - книга от центрального разработчика <code>tidyverse</code> Hadley Wickham и Garrett Grolemund.</p></li>
<li><p><a href="https://pozdniakov.github.io/tidy_stats/index.html">Анализ данных и статистика в R</a> (автор Иван Поздняков).</p></li>
<li><p><a href="https://ggplot2-book.org/">ggplot2: Elegant Graphics for Data Analysis</a> (Hadley Wickham, Danielle Navarro, and Thomas Lin Pedersen).</p></li>
<li><p><a href="https://github.com/cwickham/purrr-tutorial/blob/master/slides.pdf">Туториал по библиотеке <code>purrr</code></a> от Charlotte Wickham</p></li>
</ul>
</div><div class="column" style="width:40%;">
<div class="quarto-figure quarto-figure-right">
<figure>
<p><img data-src="https://d33wubrfki0l68.cloudfront.net/b88ef926a004b0fce72b2526b0b5c4413666a4cb/24a30/cover.png" width="364"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="подходы-к-анализу-данных-в-r" class="slide level2" style="font-size: 95%">
<h2>Подходы к анализу данных в R</h2>
<p>Можно выделить три основных подхода для манипуляций с данными в R:<br>
base R, <code>tidyverse</code>, <code>data.table</code>.</p>
<div class="fragment">
<div style="position: absolute; top: 227px; left: 5px; width: 1270px; height: 223px; background-color: rgba(169, 209, 142, 0.3); z-index: -1; border-radius: 5px;">

</div>
</div>
<div class="fragment">
<div style="position: absolute; top: 450px; left: 5px; width: 1270px; height: 200px; background-color: rgba(209, 162, 142, 0.3); z-index: -1; border-radius: 5px;">

</div>
</div>
<div class="fragment">
<table style="width:99%;">
<colgroup>
<col style="width: 5%">
<col style="width: 12%">
<col style="width: 46%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>base R</th>
<th>tidyverse</th>
<th>data.table</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>+</strong></td>
<td>Стабильный,<br>
доступен по умолчанию</td>
<td>Быстрее, чем base,<br>
много источников,<br>
понятный синтаксис, использование пайпов</td>
<td>Лаконичный синтаксис,<br>
очень быстрый,<br>
эффективный по памяти, нет зависимостей, обратная совместимость</td>
</tr>
<tr class="even">
<td><strong>-</strong></td>
<td>Медленно работает,<br>
неуклюжий синтаксис</td>
<td>Много зависимостей, медленнее чем <code>data.table</code>, бывают проблемы с обратной совместимостью</td>
<td>Лаконичный синтаксис бывает трудно расшифровать, сложнее изучать</td>
</tr>
</tbody>
</table>
<p>Если данных немного - рекомендую <code>tidyverse</code>, если таблицы измеряются в гигабайтах - <code>data.table</code>.</p>
</div>
</section>
<section id="немного-контекста" class="slide level2">
<h2>Немного контекста</h2>
<p><code>tidyverse</code> - набор пакетов для анализа данных, объединенных сходным синтаксисом и философией. Есть ключевые пакеты (core tidyverse), есть ряд дополнительных для работы с различными данными и форматами (например библиотека <code>readxl</code> для чтения .xlsx файлов).</p>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Совет:</strong></p>
</div>
<div class="callout-content">
<p>Подробнее со сравнением base/tidyverse/data.table можно ознакомиться <a href="https://mgimond.github.io/rug_2019_12/Index.html">здесь</a></p>
</div>
</div>
</div>
</section>
<section id="core-tidyverse---8-основных-пакетов" class="slide level2">
<h2>Core tidyverse - 8 основных пакетов</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p><code>dplyr</code> для манипуляций с таблицами</p></li>
<li><p><code>readr</code> для быстрого чтения и записи данных в R</p></li>
<li><p><code>tidyr</code> для приведения табличек в аккуратный вид</p></li>
<li><p><code>tibble</code> более аккуратный и быстрый вариант датафрейма</p></li>
<li><p><code>ggplot2</code> для работы с графиками</p></li>
<li><p><code>stringr</code> для работы со строками</p></li>
<li><p><code>purrr</code> для замены циклов и функций семейства <code>*apply()</code></p></li>
<li><p><code>forcats</code> для работы с факторами</p></li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="https://uopsych-r-bootcamp-2020.netlify.app/slides/images/tidyverse_packages.png"></p>
</div>
</div>
</section>
<section id="cheatsheets" class="slide level2">
<h2>Cheatsheets</h2>
<p>Для многих пакетов в <code>tidyverse</code> есть свои cheatsheets (шпаргалки) - собранные на одном листе краткие описания наиболее часто использующихся команд:</p>
<ul>
<li><p>Reading and writing: <a href="https://readr.tidyverse.org/#cheatsheet">readr</a></p></li>
<li><p>Data manipulation: <a href="https://dplyr.tidyverse.org/#cheat-sheet">dplyr</a></p></li>
<li><p>Tidying data: <a href="https://tidyr.tidyverse.org/#cheatsheet">tidyr</a></p></li>
<li><p>Visualization: <a href="https://ggplot2.tidyverse.org/#cheatsheet">ggplot2</a></p></li>
<li><p>String manipulation: <a href="https://stringr.tidyverse.org/#cheatsheet">stringr</a></p></li>
</ul>
<p>Лучше всего найти актуальные читшиты из самой RStudio: Help -&gt; Cheet Sheets (иначе можно наткнуться на устаревший читшит).</p>
</section>
<section id="установка-tidyverse" class="slide level2">
<h2>Установка tidyverse</h2>
<p>Для установки всего набора “пакета с пакетами” достаточно набрать в консоли R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Для загрузки пакета:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="философия-tidyverse-основные-принципы" class="slide level2">
<h2>Философия tidyverse: основные принципы</h2>
<ul>
<li><p>Использование и переиспользование уже существующих структур данных (прямоугольная таблица);</p></li>
<li><p>Сочетание простых функций в конвейере (пайпы);</p></li>
<li><p>Следование парадигме функционального программирования;</p></li>
<li><p>Понятный и удобный дизайн функций (например, общий префикс у сходных функций).</p></li>
</ul>
</section>
<section id="пайпы---основа-философии-tidyverse" class="slide level2 smaller">
<h2>Пайпы - основа философии tidyverse</h2>
<div>
<ul>
<li class="fragment"><p>Можно записать код так:<br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">leave_house</span>(<span class="fu">get_dressed</span>(<span class="fu">get_out_of_bed</span>(<span class="fu">wake_up</span>(me))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li class="fragment"><p>Или создать кучу промежуточных переменных:<br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>woken_up_me <span class="ot">&lt;-</span> <span class="fu">wake_up</span>(me)</span>
<span id="cb4-2"><a href="#cb4-2"></a>standing_up_me <span class="ot">&lt;-</span> <span class="fu">get_out_of_bed</span>(woken_up_me)</span>
<span id="cb4-3"><a href="#cb4-3"></a>dressed_me <span class="ot">&lt;-</span> <span class="fu">get_dressed</span>(standing_up_me)</span>
<span id="cb4-4"><a href="#cb4-4"></a>ready_me <span class="ot">&lt;-</span> <span class="fu">leave_house</span>(dressed_me)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li class="fragment"><p>Но для большей читаемости используем:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>me <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">wake_up</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="fu">get_out_of_bed</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="fu">get_dressed</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="fu">leave_house</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ul>
</div>
</section>
<section id="пайпы---классная-иллюстрация" class="slide level2">
<h2>Пайпы - классная иллюстрация</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><video data-src="figures/pipe.mp4" width="500" controls=""><a href="figures/pipe.mp4">Video</a></video></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>Без пайпов это было бы: <code>slice(decorate(bake(mix(ingredients))))</code></p>
<p>pipe - <code>%&gt;%</code> в тайдиверс стиле. Горячая клавиша: Ctrl Shift M.</p>
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>С R 4.1 добавили нативный пайп <code>|&gt;</code> (доступен без тайдиверса), однако мы будем пользоваться <code>%&gt;%</code> этим пайпом.</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="пример-использования-пайпов" class="slide level2" style="font-size: 90%">
<h2>Пример использования пайпов</h2>
<p>Например,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="dv">4</span> <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">sqrt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="fu">log</span>(<span class="at">base =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="fu">sum</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<p>Тоже самое, что и</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">sum</span>(<span class="dv">2</span>, <span class="fu">log</span>(<span class="fu">sqrt</span>(<span class="dv">4</span>), <span class="at">base =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<p>Если нужно пробросить данные в следующую функцию не на первую позицию, то можно использовать <code>.</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="dv">4</span> <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2"></a>  sqrt <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">log</span>(<span class="dv">8</span>, <span class="at">base =</span> .)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
</section>
<section id="dplyr---мощный-пакет-для-преобразования-таблиц" class="slide level2">
<h2>dplyr - мощный пакет для преобразования таблиц</h2>
<p>Есть множество <code>dplyr</code> <em>глаголов</em> (verbs), которые позволяют сделать практически любое преобразование данных. Основными и наиболее часто использующими <em>глаголами</em> являются:</p>
<ul>
<li><code>select()</code> - выбор столбцов по названию или индексу;</li>
<li><code>filter()</code> - выбор строк по условию;</li>
<li><code>mutate()</code> - создание новых колонок;</li>
<li><code>group_by()</code> - группировка;</li>
<li><code>summarise()</code> - подсчет суммарных статистик;</li>
<li><code>arrange()</code> - сортировка.</li>
</ul>
<p>Разберем каждый из них поподробнее.</p>
</section>
<section id="данные-для-работы" class="slide level2">
<h2>Данные для работы</h2>
<p>Статистики по юнитам из Warcraft 3.</p>
<p>Скачала <a href="https://www.unitstatistics.com/warcraft3/">отсюда</a> и сохранила в <a href="https://raw.githubusercontent.com/ubogoeva/tidyverse_tutorial/master/data/wc3_heroes.txt">github</a>-репозитории.</p>
<p>Загрузим данные, на этот раз с использованием функции из библиотеки <code>readr</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" data-code-line-numbers="|3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>wc3_units <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(<span class="st">'https://raw.githubusercontent.com/ubogoeva/tidyverse_tutorial/master/data/wc3_heroes.txt'</span>,</span>
<span id="cb12-2"><a href="#cb12-2"></a>                      <span class="at">col_names =</span> <span class="cn">TRUE</span>, </span>
<span id="cb12-3"><a href="#cb12-3"></a>                      <span class="at">na =</span> <span class="st">'-'</span>, </span>
<span id="cb12-4"><a href="#cb12-4"></a>                      <span class="at">name_repair =</span> <span class="st">'minimal'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-5"><a href="#cb12-5"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="co"># для правильных названий колонок</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Здесь для правильного чтения пропущенных значений используем параметр: <code>na = '-'</code>.</li>
</ul>
<!-- -->
<ul>
<li><code>janitor::clean_names()</code> для синтаксически правильных имен колонок.</li>
</ul>
</section>
<section id="посмотрим-на-данные" class="slide level2">
<h2>Посмотрим на данные</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">head</span>(wc3_units[,<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  unit     race   gold  wood   pop    hp armor_type
  &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     
1 Peasant  Human    75     0     1   220 Medium    
2 Militia  Human    NA    NA     1   220 Heavy     
3 Footman  Human   135     0     2   420 Heavy     
4 Rifleman Human   205    30     3   535 Medium    
5 Knight   Human   245    60     4   835 Heavy     
6 Priest   Human   135    10     2   290 Unarmored </code></pre>
</div>
</div>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>Кстати тоже самое можно записать с помощью пайпа:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>wc3_units <span class="sc">%&gt;%</span> head</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="чем-просто-датафрейм-отличается-от-тиббла" class="slide level2">
<h2>Чем просто датафрейм отличается от тиббла?</h2>
<p>Тиббл (tibble) из библиотеки <code>tibble</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">class</span>(wc3_units)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "spec_tbl_df" "tbl_df"      "tbl"         "data.frame" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>wc3_units</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 71 × 21
   unit    race   gold  wood   pop    hp armor…¹ armor sight speed  time groun…²
   &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  
 1 Peasant Human    75     0     1   220 Medium      0    80   190    15 Normal 
 2 Militia Human    NA    NA     1   220 Heavy       4   140   270    NA Normal 
 3 Footman Human   135     0     2   420 Heavy       2   140   270    20 Normal 
 4 Riflem… Human   205    30     3   535 Medium      0   140   270    26 Pierce 
 5 Knight  Human   245    60     4   835 Heavy       5   140   350    45 Normal 
 6 Priest  Human   135    10     2   290 Unarmo…     0   140   270    28 Magic  
 7 Sorcer… Human   155    20     2   325 Unarmo…     0   140   270    30 Magic  
 8 Spell … Human   215    30     3   600 Medium      3   140   300    28 Normal 
 9 Flying… Human    90    30     1   200 Heavy       2   180   400    13 Siege  
10 Mortar… Human   180    70     3   360 Heavy       0   140   270    40 Siege  
# … with 61 more rows, 9 more variables: damage &lt;dbl&gt;, cooldown &lt;dbl&gt;,
#   dps &lt;dbl&gt;, range &lt;dbl&gt;, air_attack &lt;chr&gt;, damage_2 &lt;dbl&gt;, cooldown_2 &lt;dbl&gt;,
#   dps_2 &lt;dbl&gt;, range_2 &lt;dbl&gt;, and abbreviated variable names ¹​armor_type,
#   ²​ground_attack</code></pre>
</div>
</div>
</section>
<section id="чем-просто-датафрейм-отличается-от-тиббла-1" class="slide level2">
<h2>Чем просто датафрейм отличается от тиббла?</h2>
<p>Обычный датафрейм:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>wc3_units_df <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">'data/wc3_units.txt'</span>, <span class="at">sep =</span> <span class="st">'</span><span class="sc">\t</span><span class="st">'</span>, </span>
<span id="cb20-2"><a href="#cb20-2"></a>                 <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">na.strings =</span> <span class="st">'-'</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a>wc3_units_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Unit   Race Gold Wood Pop   HP   Armor.Type Armor Sight Speed
1              Peasant  Human   75    0   1  220       Medium     0    80   190
2              Militia  Human   NA   NA   1  220        Heavy     4   140   270
3              Footman  Human  135    0   2  420        Heavy     2   140   270
4             Rifleman  Human  205   30   3  535       Medium     0   140   270
5               Knight  Human  245   60   4  835        Heavy     5   140   350
6               Priest  Human  135   10   2  290    Unarmored     0   140   270
7            Sorceress  Human  155   20   2  325    Unarmored     0   140   270
8        Spell Breaker  Human  215   30   3  600       Medium     3   140   300
9       Flying Machine  Human   90   30   1  200        Heavy     2   180   400
10         Mortar Team  Human  180   70   3  360        Heavy     0   140   270
11        Siege Engine  Human  195   60   3  700         Fort     2   140   220
12       Gryphon Rider  Human  280   70   4  825        Light     0   160   320
13    Dragonhawk Rider  Human  200   30   3  575        Light     1   140   350
14   Water Elemental 1  Human   NA   NA  NA  525        Heavy     0   120   220
15   Water Elemental 2  Human   NA   NA  NA  675        Heavy     1   120   220
16   Water Elemental 3  Human   NA   NA  NA  900        Heavy     2   120   220
17             Phoenix  Human   NA   NA  NA 1250        Light     1   160   320
18                Peon    Orc   75    0   1  250       Medium     0    80   190
19               Grunt    Orc  200    0   3  700        Heavy     1   140   270
20       T. Headhunter    Orc  135   20   2  350       Medium     0   140   270
21        T. Berserker    Orc  135   20   2  450       Medium     0   140   270
22          Demolisher    Orc  220   50   4  425        Heavy     2   140   220
23              Raider    Orc  180   40   3  610       Medium     1   140   350
24              Tauren    Orc  280   80   5 1300        Heavy     3   140   270
25              Shaman    Orc  130   20   2  335    Unarmored     0   140   270
26        Witch Doctor    Orc  145   25   2  315    Unarmored     0   140   270
27       Spirit Walker    Orc  195   35   3  500    Unarmored     0   140   270
28          Kodo Beast    Orc  255   60   4 1000    Unarmored     1   140   220
29          Wind Rider    Orc  265   40   4  570        Light     0   160   320
30      Troll Batrider    Orc  160   40   2  325        Light     0   140   320
31         Spirit Wolf    Orc   NA   NA  NA  200        Heavy     0   120   320
32           Dire Wolf    Orc   NA   NA  NA  300        Heavy     0   120   350
33         Shadow Wolf    Orc   NA   NA  NA  500        Heavy     0   120   350
34        Serpent Ward    Orc   NA   NA  NA   75        Heavy     0   120    NA
35                Wisp  N.Elf   60    0   1  120       Medium     0   100   270
36              Archer  N.Elf  130   10   2  245       Medium     0   140   270
37            Huntress  N.Elf  195   20   3  600    Unarmored     2   140   350
38      Glaive Thrower  N.Elf  210   65   3  300        Heavy     2   140   220
39               Dryad  N.Elf  145   60   3  435    Unarmored     0   140   350
40      DoC Druid Form  N.Elf  255   80   4  130        Heavy     1   140   270
41       DoC Bear Form  N.Elf   NA   NA   4  960        Heavy     3   140   270
42      Mountain Giant  N.Elf  425  100   7 1600       Medium     4   120   270
43    Mountain Giant 2  N.Elf  425  100   7 1600       Medium    10   120   270
44          Hippogryph  N.Elf  160   20   2  525    Unarmored     0   160   400
45      DoT Druid Form  N.Elf  135   20   2  300    Unarmored     0   140   270
46       DoT Crow Form  N.Elf   NA   NA   2  300    Unarmored     0   160   320
47       Faerie Dragon  N.Elf  155   25   2  450        Light     0   160   350
48    Hippogryph Rider  N.Elf   NA   NA   4  765        Light     1   160   350
49            Chimaera  N.Elf  330   70   5 1000        Light     2   160   250
50          Chimaera 2  N.Elf  330   70   5 1000        Light     2   160   250
51              Treant  N.Elf   NA   NA  NA  300        Heavy     0   120   220
52 Avatar of Vengeance  N.Elf   NA   NA  NA 1200        Heavy     2   120   320
53 Spirit of Vengeance  N.Elf   NA   NA  NA  500 Invulnerable    NA   120   270
54             Acolyte Undead   75    0   1  220       Medium     0    80   220
55               Ghoul Undead  120    0   2  340        Heavy     0   140   270
56         Crypt Fiend Undead  215   40   3  550       Medium     0   140   270
57            Gargoyle Undead  185   30   2  410    Unarmored     3   160   350
58         Abomination Undead  240   70   4 1175        Heavy     2   140   270
59          Meat Wagon Undead  230   50   4  380        Heavy     2   140   220
60         Necromancer Undead  145   20   2  305    Unarmored     0   140   270
61             Banshee Undead  155   30   2  285    Unarmored     0   140   270
62          Frost Wyrm Undead  385  120   7 1350        Light     1   160   270
63               Shade Undead   NA   NA   1  125       Medium     0   190   350
64    Skeleton Warrior Undead   NA   NA   0  180        Heavy     1    80   270
65       Skeletal Mage Undead   NA   NA   0  230       Medium     0   140   270
66            Infernal Undead   NA   NA  NA 1500        Heavy     6   140   320
67    Carrion Beetle 1 Undead   NA   NA   0  140        Heavy     2   120   270
68    Carrion Beetle 2 Undead   NA   NA   0  275        Heavy     2   120   270
69    Carrion Beetle 3 Undead   NA   NA   0  410        Heavy     2   120   270
70     Obsidian Statue Undead  200   35   3  550        Heavy     4   120   270
71           Destroyer Undead   NA   NA   5  900        Light     3   140   320
   Time Ground.Attack Damage Cooldown   DPS Range Air.Attack Damage.1
1    15        Normal    5.5     2.00  2.75   0.0       &lt;NA&gt;       NA
2    NA        Normal   12.5     1.20 10.42   0.0       &lt;NA&gt;       NA
3    20        Normal   12.5     1.35  9.26   0.0       &lt;NA&gt;       NA
4    26        Pierce   21.0     1.50 14.00  40.0     Pierce     21.0
5    45        Normal   34.0     1.40 24.29   0.0       &lt;NA&gt;       NA
6    28         Magic    8.5     2.00  4.25  60.0      Magic      8.5
7    30         Magic   11.0     1.75  6.29  60.0      Magic     11.0
8    28        Normal   14.0     1.90  7.37  25.0       &lt;NA&gt;       NA
9    13         Siege    7.5     2.50  3.00   0.0     Pierce     14.5
10   40         Siege   58.0     3.50 16.57 115.0       &lt;NA&gt;       NA
11   55         Siege   50.0     2.10 23.81  19.0      Siege     13.5
12   45         Magic   50.0     2.20 22.73  45.0      Magic     50.0
13   28        Pierce   19.0     1.75 10.86  30.0     Pierce     19.0
14   NA        Pierce   20.0     1.50 13.33  30.0     Pierce     20.0
15   NA        Pierce   35.0     1.50 23.33  30.0     Pierce     35.0
16   NA        Pierce   45.0     1.50 30.00  30.0     Pierce     45.0
17   NA         Magic   68.0     1.40 48.57  60.0      Magic     68.0
18   15        Normal    7.5     3.00  2.50   0.0       &lt;NA&gt;       NA
19   30        Normal   19.5     1.60 12.19   0.0       &lt;NA&gt;       NA
20   20        Pierce   25.0     2.31 10.82  45.0     Pierce     25.0
21   22        Pierce   25.0     2.31 10.82  45.0     Pierce     25.0
22   40         Siege   80.5     4.50 17.89 115.0       &lt;NA&gt;       NA
23   28         Siege   25.0     1.85 13.51   0.0       &lt;NA&gt;       NA
24   44        Normal   33.0     1.90 17.37   0.0       &lt;NA&gt;       NA
25   30         Magic    8.5     2.10  4.05  60.0      Magic      8.5
26   30         Magic   12.0     1.75  6.86  60.0      Magic     12.0
27   38         Magic   19.5     1.75 11.14  40.0      Magic     19.5
28   30        Pierce   18.0     1.44 12.50  50.0     Pierce     18.0
29   35        Pierce   40.0     2.00 20.00  45.0     Pierce     40.0
30   28         Siege   14.0     1.80  7.78  30.0       &lt;NA&gt;       NA
31   NA        Normal   11.5     1.00 11.50   0.0       &lt;NA&gt;       NA
32   NA        Normal   16.5     1.00 16.50   0.0       &lt;NA&gt;       NA
33   NA        Normal   21.5     1.00 21.50   0.0       &lt;NA&gt;       NA
34   NA        Pierce   12.0     1.50  8.00  60.0     Pierce     12.0
35   14          &lt;NA&gt;     NA       NA    NA    NA       &lt;NA&gt;       NA
36   20        Pierce   17.0     1.50 11.33  50.0     Pierce     17.0
37   30        Normal   17.0     1.80  9.44  22.0       &lt;NA&gt;       NA
38   48         Siege   44.5     3.50 12.71 115.0       &lt;NA&gt;       NA
39   30        Pierce   18.0     2.00  9.00  50.0     Pierce     18.0
40   35        Normal   20.5     1.50 13.67   0.0       &lt;NA&gt;       NA
41   NA        Normal   36.5     1.50 24.33   0.0       &lt;NA&gt;       NA
42   45        Normal   34.0     2.50 13.60   0.0       &lt;NA&gt;       NA
43   45         Siege   41.0     2.50 16.40  25.0       &lt;NA&gt;       NA
44   40          &lt;NA&gt;     NA       NA    NA    NA     Normal     53.5
45   22         Magic   12.0     1.60  7.50  60.0      Magic     12.0
46   NA         Magic     NA     1.75    NA  60.0      Magic     38.0
47   25        Pierce   15.0     1.75  8.57  30.0     Pierce     15.0
48   NA        Pierce   17.0     1.10 15.45  40.0     Pierce     17.0
49   65         Magic   75.0     2.50 30.00  45.0       &lt;NA&gt;       NA
50   65         Siege   50.0     2.50 20.00  85.0       &lt;NA&gt;       NA
51   NA        Normal   16.0     1.75  9.14   0.0       &lt;NA&gt;       NA
52   NA        Normal   30.5     1.35 22.59  45.0     Normal     30.5
53   NA        Pierce   16.0     1.35 11.85  45.0     Pierce     16.0
54   15        Normal    9.5     2.50  3.80   0.0       &lt;NA&gt;       NA
55   18        Normal   13.0     1.30 10.00   0.0       &lt;NA&gt;       NA
56   30        Pierce   28.5     2.00 14.25  55.0       &lt;NA&gt;       NA
57   35        Pierce   19.5     2.20  8.86  30.0     Normal     65.5
58   40        Normal   36.0     1.90 18.95   0.0       &lt;NA&gt;       NA
59   45         Siege   79.5     4.00 19.88 115.0       &lt;NA&gt;       NA
60   24         Magic    8.5     1.80  4.72  60.0      Magic      8.5
61   28         Magic   11.0     1.50  7.33  60.0      Magic     11.0
62   65         Magic  104.0     3.00 34.67  30.0      Magic     89.0
63   15          &lt;NA&gt;     NA       NA    NA    NA       &lt;NA&gt;       NA
64   NA        Normal   14.5     2.00  7.25   0.0       &lt;NA&gt;       NA
65   NA        Pierce   11.5     1.50  7.67  50.0     Pierce     11.5
66   NA         Chaos   54.5     1.35 40.37   0.0       &lt;NA&gt;       NA
67   NA        Normal    8.5     1.50  5.67   0.0       &lt;NA&gt;       NA
68   NA        Normal   16.5     1.50 11.00   0.0       &lt;NA&gt;       NA
69   NA        Normal   24.5     1.50 16.33   0.0       &lt;NA&gt;       NA
70   45         Magic    7.5     2.10  3.57  57.5      Magic      7.5
71   NA         Magic   20.0     1.35 14.81  45.0      Magic     20.0
   Cooldown.1 DPS.1 Range.1
1          NA    NA      NA
2          NA    NA      NA
3          NA    NA      NA
4        1.50 14.00    60.0
5          NA    NA      NA
6        2.00  4.25    60.0
7        1.75  6.29    60.0
8          NA    NA      NA
9        2.00  7.25    50.0
10         NA    NA      NA
11       2.10  6.43    50.0
12       2.40 20.83    45.0
13       1.75 10.86    30.0
14       1.50 13.33    30.0
15       1.50 23.33    30.0
16       1.50 30.00    30.0
17       1.40 48.57    60.0
18         NA    NA      NA
19         NA    NA      NA
20       2.31 10.82    45.0
21       2.31 10.82    45.0
22         NA    NA      NA
23         NA    NA      NA
24         NA    NA      NA
25       2.10  4.05    60.0
26       1.75  6.86    60.0
27       1.75 11.14    40.0
28       1.44 12.50    50.0
29       2.00 20.00    45.0
30         NA    NA      NA
31         NA    NA      NA
32         NA    NA      NA
33         NA    NA      NA
34       1.50  8.00    60.0
35         NA    NA      NA
36       1.50 11.33    50.0
37         NA    NA      NA
38         NA    NA      NA
39       2.00  9.00    50.0
40         NA    NA      NA
41         NA    NA      NA
42         NA    NA      NA
43         NA    NA      NA
44       1.05 50.95     0.0
45       1.60  7.50    60.0
46       1.75 21.71    60.0
47       1.75  8.57    30.0
48       1.10 15.45    10.0
49         NA    NA      NA
50         NA    NA      NA
51         NA    NA      NA
52       1.35 22.59    45.0
53       1.35 11.85    45.0
54         NA    NA      NA
55         NA    NA      NA
56         NA    NA      NA
57       1.40 46.79     0.0
58         NA    NA      NA
59         NA    NA      NA
60       1.80  4.72    60.0
61       1.50  7.33    60.0
62       3.00 29.67    30.0
63         NA    NA      NA
64         NA    NA      NA
65       1.50  7.67    50.0
66         NA    NA      NA
67         NA    NA      NA
68         NA    NA      NA
69         NA    NA      NA
70       2.10  3.57    57.5
71       1.35 14.81    45.0</code></pre>
</div>
</div>
<p>Тиббл более аккуратный и быстрый вариант датафрейма.</p>
</section>
<section>
<section id="работа-с-колонками" class="title-slide slide level1 center">
<h1>Работа с колонками</h1>

</section>
<section id="select---выбираем-нужные-колонки-по-названию-или-индексу" class="slide level2">
<h2><code>select()</code> - выбираем нужные колонки по названию или индексу</h2>
<p>Выбрать колонку тип брони (armor_type) по названию или индексу (без кавычек).</p>
<div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2"></a>  <span class="fu">select</span>(armor_type)</span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="co"># также по индексу:</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb22-5"><a href="#cb22-5"></a>  <span class="fu">select</span>(<span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code># A tibble: 71 × 1
   armor_type
   &lt;chr&gt;     
 1 Medium    
 2 Heavy     
 3 Heavy     
 4 Medium    
 5 Heavy     
 6 Unarmored 
 7 Unarmored 
 8 Medium    
 9 Heavy     
10 Heavy     
# … with 61 more rows</code></pre>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code># A tibble: 71 × 1
   armor_type
   &lt;chr&gt;     
 1 Medium    
 2 Heavy     
 3 Heavy     
 4 Medium    
 5 Heavy     
 6 Unarmored 
 7 Unarmored 
 8 Medium    
 9 Heavy     
10 Heavy     
# … with 61 more rows</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="select---выбираем-нужные-колонки-по-названию-или-индексу-1" class="slide level2">
<h2><code>select()</code> - выбираем нужные колонки по названию или индексу</h2>
<p>Можно выбирать несколько колонок просто перечислением или выбрать несколько колонок с одной по другую с помощью двоеточия <code>:</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2"></a>  <span class="fu">select</span>(unit, race, hp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 71 × 3
   unit           race     hp
   &lt;chr&gt;          &lt;chr&gt; &lt;dbl&gt;
 1 Peasant        Human   220
 2 Militia        Human   220
 3 Footman        Human   420
 4 Rifleman       Human   535
 5 Knight         Human   835
 6 Priest         Human   290
 7 Sorceress      Human   325
 8 Spell Breaker  Human   600
 9 Flying Machine Human   200
10 Mortar Team    Human   360
# … with 61 more rows</code></pre>
</div>
</div>
</section>
<section id="select---выбираем-нужные-колонки-по-названию-или-индексу-2" class="slide level2" style="font-size: 90%">
<h2><code>select()</code> - выбираем нужные колонки по названию или индексу</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2"></a>  <span class="fu">select</span>(unit<span class="sc">:</span>armor_type, ground_attack<span class="sc">:</span>range)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 71 × 12
   unit       race   gold  wood   pop    hp armor…¹ groun…² damage coold…³   dps
   &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1 Peasant    Human    75     0     1   220 Medium  Normal     5.5    2     2.75
 2 Militia    Human    NA    NA     1   220 Heavy   Normal    12.5    1.2  10.4 
 3 Footman    Human   135     0     2   420 Heavy   Normal    12.5    1.35  9.26
 4 Rifleman   Human   205    30     3   535 Medium  Pierce    21      1.5  14   
 5 Knight     Human   245    60     4   835 Heavy   Normal    34      1.4  24.3 
 6 Priest     Human   135    10     2   290 Unarmo… Magic      8.5    2     4.25
 7 Sorceress  Human   155    20     2   325 Unarmo… Magic     11      1.75  6.29
 8 Spell Bre… Human   215    30     3   600 Medium  Normal    14      1.9   7.37
 9 Flying Ma… Human    90    30     1   200 Heavy   Siege      7.5    2.5   3   
10 Mortar Te… Human   180    70     3   360 Heavy   Siege     58      3.5  16.6 
# … with 61 more rows, 1 more variable: range &lt;dbl&gt;, and abbreviated variable
#   names ¹​armor_type, ²​ground_attack, ³​cooldown</code></pre>
</div>
</div>
<div class="callout callout-note callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>Выбор колонок без кавычек - <a href="https://adv-r.hadley.nz/metaprogramming.html#metaprogramming">NSE</a> (not standard evaluation, выбор колонок с помощью двоеточия - концепция <a href="https://r4ds.hadley.nz/functions.html#sec-embracing"><code>tidyselect</code></a>).</p>
</div>
</div>
</div>
</section>
<section id="select-pull-для-выбора-одной-колонки" class="slide level2">
<h2><code>select()</code> + <code>pull()</code> для выбора одной колонки</h2>
<p>При селекте одной колонки она не превращается в вектор по умолчанию, а остается датасетом с одной колонкой. Но иногда мы хотим извлечь именно вектор, а не маленький датасет. В таком случае понадобится функция <code>pull()</code>.</p>
<p>Сравните:</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="#cb29-2"></a>  <span class="fu">select</span>(unit) <span class="sc">%&gt;%</span> </span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 1
  unit    
  &lt;chr&gt;   
1 Peasant 
2 Militia 
3 Footman 
4 Rifleman
5 Knight  </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2"></a>  <span class="fu">pull</span>(unit) <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="#cb31-3"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Peasant"  "Militia"  "Footman"  "Rifleman" "Knight"  </code></pre>
</div>
</div>
</div>
</div>
</section>
<section class="slide level2">

<p>В base R можно задать сохранение размерности датафрейма аргументом <code>drop = FALSE</code> при индексации.</p>
<div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a href="#cb33-2"></a>  <span class="fu">select</span>(unit) <span class="sc">%&gt;%</span> </span>
<span id="cb33-3"><a href="#cb33-3"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span>
<span id="cb33-4"><a href="#cb33-4"></a><span class="co"># тоже самое в base R с аргументом drop = FALSE</span></span>
<span id="cb33-5"><a href="#cb33-5"></a>wc3_units[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span>, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code># A tibble: 5 × 1
  unit    
  &lt;chr&gt;   
1 Peasant 
2 Militia 
3 Footman 
4 Rifleman
5 Knight  </code></pre>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code># A tibble: 5 × 1
  unit    
  &lt;chr&gt;   
1 Peasant 
2 Militia 
3 Footman 
4 Rifleman
5 Knight  </code></pre>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="работа-со-строками" class="title-slide slide level1 center">
<h1>Работа со строками</h1>

</section>
<section id="filter---выбрать-нужные-строки-по-условию" class="slide level2">
<h2><code>filter()</code> - выбрать нужные строки по условию</h2>
<p>Выберем только юнитов ночных эльфов (‘N.Elf’)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2"></a>  <span class="fu">filter</span>(race <span class="sc">==</span> <span class="st">'N.Elf'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table>
 <thead>
  <tr>
   <th style="text-align:left;"> unit </th>
   <th style="text-align:left;"> race </th>
   <th style="text-align:right;"> gold </th>
   <th style="text-align:right;"> wood </th>
   <th style="text-align:right;"> pop </th>
   <th style="text-align:right;"> hp </th>
   <th style="text-align:left;"> armor_type </th>
   <th style="text-align:right;"> armor </th>
   <th style="text-align:right;"> sight </th>
   <th style="text-align:right;"> speed </th>
   <th style="text-align:right;"> time </th>
   <th style="text-align:left;"> ground_attack </th>
   <th style="text-align:right;"> damage </th>
   <th style="text-align:right;"> cooldown </th>
   <th style="text-align:right;"> dps </th>
   <th style="text-align:right;"> range </th>
   <th style="text-align:left;"> air_attack </th>
   <th style="text-align:right;"> damage_2 </th>
   <th style="text-align:right;"> cooldown_2 </th>
   <th style="text-align:right;"> dps_2 </th>
   <th style="text-align:right;"> range_2 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Wisp </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 60 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:left;"> Medium </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 100 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Archer </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 130 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 245 </td>
   <td style="text-align:left;"> Medium </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 17.0 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 11.33 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 17.0 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 11.33 </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Huntress </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 195 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 600 </td>
   <td style="text-align:left;"> Unarmored </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 350 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 17.0 </td>
   <td style="text-align:right;"> 1.80 </td>
   <td style="text-align:right;"> 9.44 </td>
   <td style="text-align:right;"> 22 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Glaive Thrower </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 210 </td>
   <td style="text-align:right;"> 65 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 300 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:right;"> 48 </td>
   <td style="text-align:left;"> Siege </td>
   <td style="text-align:right;"> 44.5 </td>
   <td style="text-align:right;"> 3.50 </td>
   <td style="text-align:right;"> 12.71 </td>
   <td style="text-align:right;"> 115 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Dryad </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 145 </td>
   <td style="text-align:right;"> 60 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 435 </td>
   <td style="text-align:left;"> Unarmored </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 350 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 18.0 </td>
   <td style="text-align:right;"> 2.00 </td>
   <td style="text-align:right;"> 9.00 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 18.0 </td>
   <td style="text-align:right;"> 2.00 </td>
   <td style="text-align:right;"> 9.00 </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> DoC Druid Form </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 80 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 130 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 35 </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 20.5 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 13.67 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:left;"> DoC Bear Form </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 960 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 36.5 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 24.33 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Mountain Giant </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 425 </td>
   <td style="text-align:right;"> 100 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 1600 </td>
   <td style="text-align:left;"> Medium </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 45 </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 34.0 </td>
   <td style="text-align:right;"> 2.50 </td>
   <td style="text-align:right;"> 13.60 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Mountain Giant 2 </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 425 </td>
   <td style="text-align:right;"> 100 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 1600 </td>
   <td style="text-align:left;"> Medium </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 45 </td>
   <td style="text-align:left;"> Siege </td>
   <td style="text-align:right;"> 41.0 </td>
   <td style="text-align:right;"> 2.50 </td>
   <td style="text-align:right;"> 16.40 </td>
   <td style="text-align:right;"> 25 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Hippogryph </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 525 </td>
   <td style="text-align:left;"> Unarmored </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 400 </td>
   <td style="text-align:right;"> 40 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 53.5 </td>
   <td style="text-align:right;"> 1.05 </td>
   <td style="text-align:right;"> 50.95 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> DoT Druid Form </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 135 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 300 </td>
   <td style="text-align:left;"> Unarmored </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 22 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 12.0 </td>
   <td style="text-align:right;"> 1.60 </td>
   <td style="text-align:right;"> 7.50 </td>
   <td style="text-align:right;"> 60 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 12.0 </td>
   <td style="text-align:right;"> 1.60 </td>
   <td style="text-align:right;"> 7.50 </td>
   <td style="text-align:right;"> 60 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> DoT Crow Form </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 300 </td>
   <td style="text-align:left;"> Unarmored </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 320 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 1.75 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 60 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 38.0 </td>
   <td style="text-align:right;"> 1.75 </td>
   <td style="text-align:right;"> 21.71 </td>
   <td style="text-align:right;"> 60 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Faerie Dragon </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 155 </td>
   <td style="text-align:right;"> 25 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 450 </td>
   <td style="text-align:left;"> Light </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 350 </td>
   <td style="text-align:right;"> 25 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 15.0 </td>
   <td style="text-align:right;"> 1.75 </td>
   <td style="text-align:right;"> 8.57 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 15.0 </td>
   <td style="text-align:right;"> 1.75 </td>
   <td style="text-align:right;"> 8.57 </td>
   <td style="text-align:right;"> 30 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Hippogryph Rider </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 765 </td>
   <td style="text-align:left;"> Light </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 350 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 17.0 </td>
   <td style="text-align:right;"> 1.10 </td>
   <td style="text-align:right;"> 15.45 </td>
   <td style="text-align:right;"> 40 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 17.0 </td>
   <td style="text-align:right;"> 1.10 </td>
   <td style="text-align:right;"> 15.45 </td>
   <td style="text-align:right;"> 10 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Chimaera </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 330 </td>
   <td style="text-align:right;"> 70 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 1000 </td>
   <td style="text-align:left;"> Light </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 250 </td>
   <td style="text-align:right;"> 65 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 75.0 </td>
   <td style="text-align:right;"> 2.50 </td>
   <td style="text-align:right;"> 30.00 </td>
   <td style="text-align:right;"> 45 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Chimaera 2 </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 330 </td>
   <td style="text-align:right;"> 70 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 1000 </td>
   <td style="text-align:left;"> Light </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 250 </td>
   <td style="text-align:right;"> 65 </td>
   <td style="text-align:left;"> Siege </td>
   <td style="text-align:right;"> 50.0 </td>
   <td style="text-align:right;"> 2.50 </td>
   <td style="text-align:right;"> 20.00 </td>
   <td style="text-align:right;"> 85 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Treant </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 300 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 16.0 </td>
   <td style="text-align:right;"> 1.75 </td>
   <td style="text-align:right;"> 9.14 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Avatar of Vengeance </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 1200 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> 320 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 30.5 </td>
   <td style="text-align:right;"> 1.35 </td>
   <td style="text-align:right;"> 22.59 </td>
   <td style="text-align:right;"> 45 </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 30.5 </td>
   <td style="text-align:right;"> 1.35 </td>
   <td style="text-align:right;"> 22.59 </td>
   <td style="text-align:right;"> 45 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Spirit of Vengeance </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 500 </td>
   <td style="text-align:left;"> Invulnerable </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 16.0 </td>
   <td style="text-align:right;"> 1.35 </td>
   <td style="text-align:right;"> 11.85 </td>
   <td style="text-align:right;"> 45 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 16.0 </td>
   <td style="text-align:right;"> 1.35 </td>
   <td style="text-align:right;"> 11.85 </td>
   <td style="text-align:right;"> 45 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="filter---выбрать-нужные-строки-по-условию-1" class="slide level2 smaller">
<h2><code>filter()</code> - выбрать нужные строки по условию</h2>
<p>Можно комбинировать несколько условий, используя логическое И (<code>&amp;</code>), ИЛИ (<code>|</code>). Например, выберем только юнитов ночных эльфов, показатель урона (damage) которых больше 40:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2"></a>  <span class="fu">filter</span>(race <span class="sc">==</span> <span class="st">'N.Elf'</span> <span class="sc">&amp;</span> damage <span class="sc">&gt;</span> <span class="dv">40</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table>
 <thead>
  <tr>
   <th style="text-align:left;"> unit </th>
   <th style="text-align:left;"> race </th>
   <th style="text-align:right;"> gold </th>
   <th style="text-align:right;"> wood </th>
   <th style="text-align:right;"> pop </th>
   <th style="text-align:right;"> hp </th>
   <th style="text-align:left;"> armor_type </th>
   <th style="text-align:right;"> armor </th>
   <th style="text-align:right;"> sight </th>
   <th style="text-align:right;"> speed </th>
   <th style="text-align:right;"> time </th>
   <th style="text-align:left;"> ground_attack </th>
   <th style="text-align:right;"> damage </th>
   <th style="text-align:right;"> cooldown </th>
   <th style="text-align:right;"> dps </th>
   <th style="text-align:right;"> range </th>
   <th style="text-align:left;"> air_attack </th>
   <th style="text-align:right;"> damage_2 </th>
   <th style="text-align:right;"> cooldown_2 </th>
   <th style="text-align:right;"> dps_2 </th>
   <th style="text-align:right;"> range_2 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Glaive Thrower </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 210 </td>
   <td style="text-align:right;"> 65 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 300 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:right;"> 48 </td>
   <td style="text-align:left;"> Siege </td>
   <td style="text-align:right;"> 44.5 </td>
   <td style="text-align:right;"> 3.5 </td>
   <td style="text-align:right;"> 12.71 </td>
   <td style="text-align:right;"> 115 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Mountain Giant 2 </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 425 </td>
   <td style="text-align:right;"> 100 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 1600 </td>
   <td style="text-align:left;"> Medium </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 45 </td>
   <td style="text-align:left;"> Siege </td>
   <td style="text-align:right;"> 41.0 </td>
   <td style="text-align:right;"> 2.5 </td>
   <td style="text-align:right;"> 16.40 </td>
   <td style="text-align:right;"> 25 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Chimaera </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 330 </td>
   <td style="text-align:right;"> 70 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 1000 </td>
   <td style="text-align:left;"> Light </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 250 </td>
   <td style="text-align:right;"> 65 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 75.0 </td>
   <td style="text-align:right;"> 2.5 </td>
   <td style="text-align:right;"> 30.00 </td>
   <td style="text-align:right;"> 45 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Chimaera 2 </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 330 </td>
   <td style="text-align:right;"> 70 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 1000 </td>
   <td style="text-align:left;"> Light </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 250 </td>
   <td style="text-align:right;"> 65 </td>
   <td style="text-align:left;"> Siege </td>
   <td style="text-align:right;"> 50.0 </td>
   <td style="text-align:right;"> 2.5 </td>
   <td style="text-align:right;"> 20.00 </td>
   <td style="text-align:right;"> 85 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="slice---выбираем-строки-по-индексу" class="slide level2">
<h2><code>slice()</code> - выбираем строки по индексу</h2>
<p><code>slice()</code> - вывести строки в опреденном диапазоне (используя просто индексы строк)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb38-2"><a href="#cb38-2"></a>  <span class="fu">slice</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 21
  unit     race   gold  wood   pop    hp armor…¹ armor sight speed  time groun…²
  &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  
1 Mortar … Human   180    70     3   360 Heavy       0   140   270    40 Siege  
2 Siege E… Human   195    60     3   700 Fort        2   140   220    55 Siege  
3 Gryphon… Human   280    70     4   825 Light       0   160   320    45 Magic  
4 Dragonh… Human   200    30     3   575 Light       1   140   350    28 Pierce 
5 Water E… Human    NA    NA    NA   525 Heavy       0   120   220    NA Pierce 
6 Water E… Human    NA    NA    NA   675 Heavy       1   120   220    NA Pierce 
# … with 9 more variables: damage &lt;dbl&gt;, cooldown &lt;dbl&gt;, dps &lt;dbl&gt;,
#   range &lt;dbl&gt;, air_attack &lt;chr&gt;, damage_2 &lt;dbl&gt;, cooldown_2 &lt;dbl&gt;,
#   dps_2 &lt;dbl&gt;, range_2 &lt;dbl&gt;, and abbreviated variable names ¹​armor_type,
#   ²​ground_attack</code></pre>
</div>
</div>
</section>
<section id="slice_max-slice_min" class="slide level2">
<h2><code>slice_max()</code>, <code>slice_min()</code></h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><code>slice_max()</code> - вывести максимальные значения по какому-то признаку</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb40-2"><a href="#cb40-2"></a>  <span class="fu">slice_max</span>(wood, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="co"># важно эксплицитно писать параметр n = </span></span>
<span id="cb40-3"><a href="#cb40-3"></a>  <span class="fu">select</span>(unit, race, wood)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  unit             race    wood
  &lt;chr&gt;            &lt;chr&gt;  &lt;dbl&gt;
1 Frost Wyrm       Undead   120
2 Mountain Giant   N.Elf    100
3 Mountain Giant 2 N.Elf    100
4 Tauren           Orc       80
5 DoC Druid Form   N.Elf     80</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><code>slice_min()</code> - вывести минимальные значения по какому-то признаку</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="#cb42-2"></a>  <span class="fu">slice_min</span>(hp, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb42-3"><a href="#cb42-3"></a>  <span class="fu">select</span>(unit, race, hp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  unit             race      hp
  &lt;chr&gt;            &lt;chr&gt;  &lt;dbl&gt;
1 Serpent Ward     Orc       75
2 Wisp             N.Elf    120
3 Shade            Undead   125
4 DoC Druid Form   N.Elf    130
5 Carrion Beetle 1 Undead   140</code></pre>
</div>
</div>
</div>
</div>
<p>Функции <code>slice_max/slice_min()</code> сортируют выдачу, в отличие от теперь устаревшей <code>top_n()</code>.</p>
</section>
<section id="slice_sample---вывести-случайные-строки" class="slide level2">
<h2><code>slice_sample()</code> - вывести случайные строки</h2>
<p>В функции <code>slice_sample()</code> нужен аргумент <code>n</code>, обозначающий количество строк для печати.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb44-2"><a href="#cb44-2"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 21
  unit     race   gold  wood   pop    hp armor…¹ armor sight speed  time groun…²
  &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  
1 DoC Dru… N.Elf   255    80     4   130 Heavy       1   140   270    35 Normal 
2 Faerie … N.Elf   155    25     2   450 Light       0   160   350    25 Pierce 
3 Grunt    Orc     200     0     3   700 Heavy       1   140   270    30 Normal 
4 Footman  Human   135     0     2   420 Heavy       2   140   270    20 Normal 
5 Dryad    N.Elf   145    60     3   435 Unarmo…     0   140   350    30 Pierce 
6 Mortar … Human   180    70     3   360 Heavy       0   140   270    40 Siege  
# … with 9 more variables: damage &lt;dbl&gt;, cooldown &lt;dbl&gt;, dps &lt;dbl&gt;,
#   range &lt;dbl&gt;, air_attack &lt;chr&gt;, damage_2 &lt;dbl&gt;, cooldown_2 &lt;dbl&gt;,
#   dps_2 &lt;dbl&gt;, range_2 &lt;dbl&gt;, and abbreviated variable names ¹​armor_type,
#   ²​ground_attack</code></pre>
</div>
</div>
<p>Полезно, чтобы посмотреть часть датафрейма.</p>
</section>
<section id="selectfilter" class="slide level2">
<h2>select/filter</h2>
<p>Мнемоническое правило, чтобы не забыть, к чему относится select и filter</p>
<p>Sele<strong>C</strong>t - <strong>C</strong>olumn</p>
<p>Filte<strong>R</strong> - <strong>R</strong>ow</p>

<img data-src="figures/select_vs_filter.png" width="3000" class="r-stretch"></section></section>
<section>
<section id="изменение-колонок" class="title-slide slide level1 center">
<h1>Изменение колонок</h1>

</section>
<section id="mutate---создать-новую-колонку-или-изменить-существующую" class="slide level2">
<h2><code>mutate()</code> - создать новую колонку или изменить существующую</h2>
<p>Можно просто составить новую колонку из предыдущих, используя синтаксис <code>mutate(column_name = &lt;expression&gt;).</code></p>
<p>Проверим, что dps (damage per second) = damage / cooldown</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2"></a>  <span class="fu">mutate</span>(<span class="at">damage_per_second =</span> damage <span class="sc">/</span> cooldown) <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="#cb46-3"></a>  <span class="fu">select</span>(unit, damage, cooldown, damage_per_second, dps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>Такая операция легко делается и в базовом R, например</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>wc3_units<span class="sc">$</span>damage_per_second <span class="ot">&lt;-</span> wc3_units<span class="sc">$</span>damage <span class="sc">/</span> wc3_units<span class="sc">$</span>cooldown</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="mutate---создать-новую-колонку-или-изменить-существующую-output" class="slide level2 output-location-slide"><h2><code>mutate()</code> - создать новую колонку или изменить существующую</h2><div class="cell output-location-slide">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 71 × 5
   unit           damage cooldown damage_per_second   dps
   &lt;chr&gt;           &lt;dbl&gt;    &lt;dbl&gt;             &lt;dbl&gt; &lt;dbl&gt;
 1 Peasant           5.5     2                 2.75  2.75
 2 Militia          12.5     1.2              10.4  10.4 
 3 Footman          12.5     1.35              9.26  9.26
 4 Rifleman         21       1.5              14    14   
 5 Knight           34       1.4              24.3  24.3 
 6 Priest            8.5     2                 4.25  4.25
 7 Sorceress        11       1.75              6.29  6.29
 8 Spell Breaker    14       1.9               7.37  7.37
 9 Flying Machine    7.5     2.5               3     3   
10 Mortar Team      58       3.5              16.6  16.6 
# … with 61 more rows</code></pre>
</div>
</div></section><section id="mutate---создать-новую-колонку-или-изменить-существующую-1" class="slide level2">
<h2><code>mutate()</code> - создать новую колонку или изменить существующую</h2>
<p>Узнаем показатель отношения dps / на число пищи, чтобы узнать какие юниты самые эффективные.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>dps_food <span class="ot">&lt;-</span> wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb49-2"><a href="#cb49-2"></a>  <span class="fu">mutate</span>(<span class="at">dps_food_ratio =</span> dps <span class="sc">/</span> pop) <span class="sc">%&gt;%</span> </span>
<span id="cb49-3"><a href="#cb49-3"></a>  <span class="fu">relocate</span>(dps_food_ratio, <span class="at">.after =</span> unit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table class="table table-striped" style="font-size: 28px; width: auto !important; ">
 <thead>
  <tr>
   <th style="text-align:left;"> unit </th>
   <th style="text-align:right;"> dps_food_ratio </th>
   <th style="text-align:left;"> race </th>
   <th style="text-align:right;"> gold </th>
   <th style="text-align:right;"> wood </th>
   <th style="text-align:right;"> pop </th>
   <th style="text-align:right;"> hp </th>
   <th style="text-align:left;"> armor_type </th>
   <th style="text-align:right;"> armor </th>
   <th style="text-align:right;"> sight </th>
   <th style="text-align:right;"> speed </th>
   <th style="text-align:right;"> time </th>
   <th style="text-align:left;"> ground_attack </th>
   <th style="text-align:right;"> damage </th>
   <th style="text-align:right;"> cooldown </th>
   <th style="text-align:right;"> dps </th>
   <th style="text-align:right;"> range </th>
   <th style="text-align:left;"> air_attack </th>
   <th style="text-align:right;"> damage_2 </th>
   <th style="text-align:right;"> cooldown_2 </th>
   <th style="text-align:right;"> dps_2 </th>
   <th style="text-align:right;"> range_2 </th>
   <th style="text-align:right;"> damage_per_second </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Peasant </td>
   <td style="text-align:right;"> 2.750000 </td>
   <td style="text-align:left;"> Human </td>
   <td style="text-align:right;"> 75 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:left;"> Medium </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 80 </td>
   <td style="text-align:right;"> 190 </td>
   <td style="text-align:right;"> 15 </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 5.5 </td>
   <td style="text-align:right;"> 2.00 </td>
   <td style="text-align:right;"> 2.75 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 2.750000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Militia </td>
   <td style="text-align:right;"> 10.420000 </td>
   <td style="text-align:left;"> Human </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 12.5 </td>
   <td style="text-align:right;"> 1.20 </td>
   <td style="text-align:right;"> 10.42 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 10.416667 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Footman </td>
   <td style="text-align:right;"> 4.630000 </td>
   <td style="text-align:left;"> Human </td>
   <td style="text-align:right;"> 135 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 420 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 12.5 </td>
   <td style="text-align:right;"> 1.35 </td>
   <td style="text-align:right;"> 9.26 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 9.259259 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Rifleman </td>
   <td style="text-align:right;"> 4.666667 </td>
   <td style="text-align:left;"> Human </td>
   <td style="text-align:right;"> 205 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 535 </td>
   <td style="text-align:left;"> Medium </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 26 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 21.0 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 14.00 </td>
   <td style="text-align:right;"> 40.0 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 21.0 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 14.00 </td>
   <td style="text-align:right;"> 60.0 </td>
   <td style="text-align:right;"> 14.000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Knight </td>
   <td style="text-align:right;"> 6.072500 </td>
   <td style="text-align:left;"> Human </td>
   <td style="text-align:right;"> 245 </td>
   <td style="text-align:right;"> 60 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 835 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 350 </td>
   <td style="text-align:right;"> 45 </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 34.0 </td>
   <td style="text-align:right;"> 1.40 </td>
   <td style="text-align:right;"> 24.29 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 24.285714 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Priest </td>
   <td style="text-align:right;"> 2.125000 </td>
   <td style="text-align:left;"> Human </td>
   <td style="text-align:right;"> 135 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 290 </td>
   <td style="text-align:left;"> Unarmored </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 28 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 8.5 </td>
   <td style="text-align:right;"> 2.00 </td>
   <td style="text-align:right;"> 4.25 </td>
   <td style="text-align:right;"> 60.0 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 8.5 </td>
   <td style="text-align:right;"> 2.00 </td>
   <td style="text-align:right;"> 4.25 </td>
   <td style="text-align:right;"> 60.0 </td>
   <td style="text-align:right;"> 4.250000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sorceress </td>
   <td style="text-align:right;"> 3.145000 </td>
   <td style="text-align:left;"> Human </td>
   <td style="text-align:right;"> 155 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 325 </td>
   <td style="text-align:left;"> Unarmored </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 11.0 </td>
   <td style="text-align:right;"> 1.75 </td>
   <td style="text-align:right;"> 6.29 </td>
   <td style="text-align:right;"> 60.0 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 11.0 </td>
   <td style="text-align:right;"> 1.75 </td>
   <td style="text-align:right;"> 6.29 </td>
   <td style="text-align:right;"> 60.0 </td>
   <td style="text-align:right;"> 6.285714 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Spell Breaker </td>
   <td style="text-align:right;"> 2.456667 </td>
   <td style="text-align:left;"> Human </td>
   <td style="text-align:right;"> 215 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 600 </td>
   <td style="text-align:left;"> Medium </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 300 </td>
   <td style="text-align:right;"> 28 </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 14.0 </td>
   <td style="text-align:right;"> 1.90 </td>
   <td style="text-align:right;"> 7.37 </td>
   <td style="text-align:right;"> 25.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 7.368421 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Flying Machine </td>
   <td style="text-align:right;"> 3.000000 </td>
   <td style="text-align:left;"> Human </td>
   <td style="text-align:right;"> 90 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 200 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 180 </td>
   <td style="text-align:right;"> 400 </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:left;"> Siege </td>
   <td style="text-align:right;"> 7.5 </td>
   <td style="text-align:right;"> 2.50 </td>
   <td style="text-align:right;"> 3.00 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 14.5 </td>
   <td style="text-align:right;"> 2.00 </td>
   <td style="text-align:right;"> 7.25 </td>
   <td style="text-align:right;"> 50.0 </td>
   <td style="text-align:right;"> 3.000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Mortar Team </td>
   <td style="text-align:right;"> 5.523333 </td>
   <td style="text-align:left;"> Human </td>
   <td style="text-align:right;"> 180 </td>
   <td style="text-align:right;"> 70 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 360 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 40 </td>
   <td style="text-align:left;"> Siege </td>
   <td style="text-align:right;"> 58.0 </td>
   <td style="text-align:right;"> 3.50 </td>
   <td style="text-align:right;"> 16.57 </td>
   <td style="text-align:right;"> 115.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 16.571429 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Siege Engine </td>
   <td style="text-align:right;"> 7.936667 </td>
   <td style="text-align:left;"> Human </td>
   <td style="text-align:right;"> 195 </td>
   <td style="text-align:right;"> 60 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 700 </td>
   <td style="text-align:left;"> Fort </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:right;"> 55 </td>
   <td style="text-align:left;"> Siege </td>
   <td style="text-align:right;"> 50.0 </td>
   <td style="text-align:right;"> 2.10 </td>
   <td style="text-align:right;"> 23.81 </td>
   <td style="text-align:right;"> 19.0 </td>
   <td style="text-align:left;"> Siege </td>
   <td style="text-align:right;"> 13.5 </td>
   <td style="text-align:right;"> 2.10 </td>
   <td style="text-align:right;"> 6.43 </td>
   <td style="text-align:right;"> 50.0 </td>
   <td style="text-align:right;"> 23.809524 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Gryphon Rider </td>
   <td style="text-align:right;"> 5.682500 </td>
   <td style="text-align:left;"> Human </td>
   <td style="text-align:right;"> 280 </td>
   <td style="text-align:right;"> 70 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 825 </td>
   <td style="text-align:left;"> Light </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 320 </td>
   <td style="text-align:right;"> 45 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 50.0 </td>
   <td style="text-align:right;"> 2.20 </td>
   <td style="text-align:right;"> 22.73 </td>
   <td style="text-align:right;"> 45.0 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 50.0 </td>
   <td style="text-align:right;"> 2.40 </td>
   <td style="text-align:right;"> 20.83 </td>
   <td style="text-align:right;"> 45.0 </td>
   <td style="text-align:right;"> 22.727273 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Dragonhawk Rider </td>
   <td style="text-align:right;"> 3.620000 </td>
   <td style="text-align:left;"> Human </td>
   <td style="text-align:right;"> 200 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 575 </td>
   <td style="text-align:left;"> Light </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 350 </td>
   <td style="text-align:right;"> 28 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 19.0 </td>
   <td style="text-align:right;"> 1.75 </td>
   <td style="text-align:right;"> 10.86 </td>
   <td style="text-align:right;"> 30.0 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 19.0 </td>
   <td style="text-align:right;"> 1.75 </td>
   <td style="text-align:right;"> 10.86 </td>
   <td style="text-align:right;"> 30.0 </td>
   <td style="text-align:right;"> 10.857143 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Water Elemental 1 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Human </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 525 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 20.0 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 13.33 </td>
   <td style="text-align:right;"> 30.0 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 20.0 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 13.33 </td>
   <td style="text-align:right;"> 30.0 </td>
   <td style="text-align:right;"> 13.333333 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Water Elemental 2 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Human </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 675 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 35.0 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 23.33 </td>
   <td style="text-align:right;"> 30.0 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 35.0 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 23.33 </td>
   <td style="text-align:right;"> 30.0 </td>
   <td style="text-align:right;"> 23.333333 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Water Elemental 3 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Human </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 900 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 45.0 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 30.00 </td>
   <td style="text-align:right;"> 30.0 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 45.0 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 30.00 </td>
   <td style="text-align:right;"> 30.0 </td>
   <td style="text-align:right;"> 30.000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Phoenix </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Human </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 1250 </td>
   <td style="text-align:left;"> Light </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 320 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 68.0 </td>
   <td style="text-align:right;"> 1.40 </td>
   <td style="text-align:right;"> 48.57 </td>
   <td style="text-align:right;"> 60.0 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 68.0 </td>
   <td style="text-align:right;"> 1.40 </td>
   <td style="text-align:right;"> 48.57 </td>
   <td style="text-align:right;"> 60.0 </td>
   <td style="text-align:right;"> 48.571429 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Peon </td>
   <td style="text-align:right;"> 2.500000 </td>
   <td style="text-align:left;"> Orc </td>
   <td style="text-align:right;"> 75 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 250 </td>
   <td style="text-align:left;"> Medium </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 80 </td>
   <td style="text-align:right;"> 190 </td>
   <td style="text-align:right;"> 15 </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 7.5 </td>
   <td style="text-align:right;"> 3.00 </td>
   <td style="text-align:right;"> 2.50 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 2.500000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Grunt </td>
   <td style="text-align:right;"> 4.063333 </td>
   <td style="text-align:left;"> Orc </td>
   <td style="text-align:right;"> 200 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 700 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 19.5 </td>
   <td style="text-align:right;"> 1.60 </td>
   <td style="text-align:right;"> 12.19 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 12.187500 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> T. Headhunter </td>
   <td style="text-align:right;"> 5.410000 </td>
   <td style="text-align:left;"> Orc </td>
   <td style="text-align:right;"> 135 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 350 </td>
   <td style="text-align:left;"> Medium </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 25.0 </td>
   <td style="text-align:right;"> 2.31 </td>
   <td style="text-align:right;"> 10.82 </td>
   <td style="text-align:right;"> 45.0 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 25.0 </td>
   <td style="text-align:right;"> 2.31 </td>
   <td style="text-align:right;"> 10.82 </td>
   <td style="text-align:right;"> 45.0 </td>
   <td style="text-align:right;"> 10.822511 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> T. Berserker </td>
   <td style="text-align:right;"> 5.410000 </td>
   <td style="text-align:left;"> Orc </td>
   <td style="text-align:right;"> 135 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 450 </td>
   <td style="text-align:left;"> Medium </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 22 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 25.0 </td>
   <td style="text-align:right;"> 2.31 </td>
   <td style="text-align:right;"> 10.82 </td>
   <td style="text-align:right;"> 45.0 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 25.0 </td>
   <td style="text-align:right;"> 2.31 </td>
   <td style="text-align:right;"> 10.82 </td>
   <td style="text-align:right;"> 45.0 </td>
   <td style="text-align:right;"> 10.822511 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Demolisher </td>
   <td style="text-align:right;"> 4.472500 </td>
   <td style="text-align:left;"> Orc </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 425 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:right;"> 40 </td>
   <td style="text-align:left;"> Siege </td>
   <td style="text-align:right;"> 80.5 </td>
   <td style="text-align:right;"> 4.50 </td>
   <td style="text-align:right;"> 17.89 </td>
   <td style="text-align:right;"> 115.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 17.888889 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Raider </td>
   <td style="text-align:right;"> 4.503333 </td>
   <td style="text-align:left;"> Orc </td>
   <td style="text-align:right;"> 180 </td>
   <td style="text-align:right;"> 40 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 610 </td>
   <td style="text-align:left;"> Medium </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 350 </td>
   <td style="text-align:right;"> 28 </td>
   <td style="text-align:left;"> Siege </td>
   <td style="text-align:right;"> 25.0 </td>
   <td style="text-align:right;"> 1.85 </td>
   <td style="text-align:right;"> 13.51 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 13.513514 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Tauren </td>
   <td style="text-align:right;"> 3.474000 </td>
   <td style="text-align:left;"> Orc </td>
   <td style="text-align:right;"> 280 </td>
   <td style="text-align:right;"> 80 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 1300 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 44 </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 33.0 </td>
   <td style="text-align:right;"> 1.90 </td>
   <td style="text-align:right;"> 17.37 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 17.368421 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Shaman </td>
   <td style="text-align:right;"> 2.025000 </td>
   <td style="text-align:left;"> Orc </td>
   <td style="text-align:right;"> 130 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 335 </td>
   <td style="text-align:left;"> Unarmored </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 8.5 </td>
   <td style="text-align:right;"> 2.10 </td>
   <td style="text-align:right;"> 4.05 </td>
   <td style="text-align:right;"> 60.0 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 8.5 </td>
   <td style="text-align:right;"> 2.10 </td>
   <td style="text-align:right;"> 4.05 </td>
   <td style="text-align:right;"> 60.0 </td>
   <td style="text-align:right;"> 4.047619 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Witch Doctor </td>
   <td style="text-align:right;"> 3.430000 </td>
   <td style="text-align:left;"> Orc </td>
   <td style="text-align:right;"> 145 </td>
   <td style="text-align:right;"> 25 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 315 </td>
   <td style="text-align:left;"> Unarmored </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 12.0 </td>
   <td style="text-align:right;"> 1.75 </td>
   <td style="text-align:right;"> 6.86 </td>
   <td style="text-align:right;"> 60.0 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 12.0 </td>
   <td style="text-align:right;"> 1.75 </td>
   <td style="text-align:right;"> 6.86 </td>
   <td style="text-align:right;"> 60.0 </td>
   <td style="text-align:right;"> 6.857143 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Spirit Walker </td>
   <td style="text-align:right;"> 3.713333 </td>
   <td style="text-align:left;"> Orc </td>
   <td style="text-align:right;"> 195 </td>
   <td style="text-align:right;"> 35 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 500 </td>
   <td style="text-align:left;"> Unarmored </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 38 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 19.5 </td>
   <td style="text-align:right;"> 1.75 </td>
   <td style="text-align:right;"> 11.14 </td>
   <td style="text-align:right;"> 40.0 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 19.5 </td>
   <td style="text-align:right;"> 1.75 </td>
   <td style="text-align:right;"> 11.14 </td>
   <td style="text-align:right;"> 40.0 </td>
   <td style="text-align:right;"> 11.142857 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Kodo Beast </td>
   <td style="text-align:right;"> 3.125000 </td>
   <td style="text-align:left;"> Orc </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 60 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 1000 </td>
   <td style="text-align:left;"> Unarmored </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 18.0 </td>
   <td style="text-align:right;"> 1.44 </td>
   <td style="text-align:right;"> 12.50 </td>
   <td style="text-align:right;"> 50.0 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 18.0 </td>
   <td style="text-align:right;"> 1.44 </td>
   <td style="text-align:right;"> 12.50 </td>
   <td style="text-align:right;"> 50.0 </td>
   <td style="text-align:right;"> 12.500000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Wind Rider </td>
   <td style="text-align:right;"> 5.000000 </td>
   <td style="text-align:left;"> Orc </td>
   <td style="text-align:right;"> 265 </td>
   <td style="text-align:right;"> 40 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 570 </td>
   <td style="text-align:left;"> Light </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 320 </td>
   <td style="text-align:right;"> 35 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 40.0 </td>
   <td style="text-align:right;"> 2.00 </td>
   <td style="text-align:right;"> 20.00 </td>
   <td style="text-align:right;"> 45.0 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 40.0 </td>
   <td style="text-align:right;"> 2.00 </td>
   <td style="text-align:right;"> 20.00 </td>
   <td style="text-align:right;"> 45.0 </td>
   <td style="text-align:right;"> 20.000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Troll Batrider </td>
   <td style="text-align:right;"> 3.890000 </td>
   <td style="text-align:left;"> Orc </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 40 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 325 </td>
   <td style="text-align:left;"> Light </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 320 </td>
   <td style="text-align:right;"> 28 </td>
   <td style="text-align:left;"> Siege </td>
   <td style="text-align:right;"> 14.0 </td>
   <td style="text-align:right;"> 1.80 </td>
   <td style="text-align:right;"> 7.78 </td>
   <td style="text-align:right;"> 30.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 7.777778 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Spirit Wolf </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Orc </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 200 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> 320 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 11.5 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 11.50 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 11.500000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Dire Wolf </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Orc </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 300 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> 350 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 16.5 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 16.50 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 16.500000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Shadow Wolf </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Orc </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 500 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> 350 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 21.5 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 21.50 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 21.500000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Serpent Ward </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Orc </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 75 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 12.0 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 8.00 </td>
   <td style="text-align:right;"> 60.0 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 12.0 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 8.00 </td>
   <td style="text-align:right;"> 60.0 </td>
   <td style="text-align:right;"> 8.000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Wisp </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 60 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:left;"> Medium </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 100 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Archer </td>
   <td style="text-align:right;"> 5.665000 </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 130 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 245 </td>
   <td style="text-align:left;"> Medium </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 17.0 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 11.33 </td>
   <td style="text-align:right;"> 50.0 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 17.0 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 11.33 </td>
   <td style="text-align:right;"> 50.0 </td>
   <td style="text-align:right;"> 11.333333 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Huntress </td>
   <td style="text-align:right;"> 3.146667 </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 195 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 600 </td>
   <td style="text-align:left;"> Unarmored </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 350 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 17.0 </td>
   <td style="text-align:right;"> 1.80 </td>
   <td style="text-align:right;"> 9.44 </td>
   <td style="text-align:right;"> 22.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 9.444444 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Glaive Thrower </td>
   <td style="text-align:right;"> 4.236667 </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 210 </td>
   <td style="text-align:right;"> 65 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 300 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:right;"> 48 </td>
   <td style="text-align:left;"> Siege </td>
   <td style="text-align:right;"> 44.5 </td>
   <td style="text-align:right;"> 3.50 </td>
   <td style="text-align:right;"> 12.71 </td>
   <td style="text-align:right;"> 115.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 12.714286 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Dryad </td>
   <td style="text-align:right;"> 3.000000 </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 145 </td>
   <td style="text-align:right;"> 60 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 435 </td>
   <td style="text-align:left;"> Unarmored </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 350 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 18.0 </td>
   <td style="text-align:right;"> 2.00 </td>
   <td style="text-align:right;"> 9.00 </td>
   <td style="text-align:right;"> 50.0 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 18.0 </td>
   <td style="text-align:right;"> 2.00 </td>
   <td style="text-align:right;"> 9.00 </td>
   <td style="text-align:right;"> 50.0 </td>
   <td style="text-align:right;"> 9.000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> DoC Druid Form </td>
   <td style="text-align:right;"> 3.417500 </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 80 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 130 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 35 </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 20.5 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 13.67 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 13.666667 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> DoC Bear Form </td>
   <td style="text-align:right;"> 6.082500 </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 960 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 36.5 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 24.33 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 24.333333 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Mountain Giant </td>
   <td style="text-align:right;"> 1.942857 </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 425 </td>
   <td style="text-align:right;"> 100 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 1600 </td>
   <td style="text-align:left;"> Medium </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 45 </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 34.0 </td>
   <td style="text-align:right;"> 2.50 </td>
   <td style="text-align:right;"> 13.60 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 13.600000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Mountain Giant 2 </td>
   <td style="text-align:right;"> 2.342857 </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 425 </td>
   <td style="text-align:right;"> 100 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 1600 </td>
   <td style="text-align:left;"> Medium </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 45 </td>
   <td style="text-align:left;"> Siege </td>
   <td style="text-align:right;"> 41.0 </td>
   <td style="text-align:right;"> 2.50 </td>
   <td style="text-align:right;"> 16.40 </td>
   <td style="text-align:right;"> 25.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 16.400000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Hippogryph </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 525 </td>
   <td style="text-align:left;"> Unarmored </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 400 </td>
   <td style="text-align:right;"> 40 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 53.5 </td>
   <td style="text-align:right;"> 1.05 </td>
   <td style="text-align:right;"> 50.95 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:right;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:left;"> DoT Druid Form </td>
   <td style="text-align:right;"> 3.750000 </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 135 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 300 </td>
   <td style="text-align:left;"> Unarmored </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 22 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 12.0 </td>
   <td style="text-align:right;"> 1.60 </td>
   <td style="text-align:right;"> 7.50 </td>
   <td style="text-align:right;"> 60.0 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 12.0 </td>
   <td style="text-align:right;"> 1.60 </td>
   <td style="text-align:right;"> 7.50 </td>
   <td style="text-align:right;"> 60.0 </td>
   <td style="text-align:right;"> 7.500000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> DoT Crow Form </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 300 </td>
   <td style="text-align:left;"> Unarmored </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 320 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 1.75 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 60.0 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 38.0 </td>
   <td style="text-align:right;"> 1.75 </td>
   <td style="text-align:right;"> 21.71 </td>
   <td style="text-align:right;"> 60.0 </td>
   <td style="text-align:right;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Faerie Dragon </td>
   <td style="text-align:right;"> 4.285000 </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 155 </td>
   <td style="text-align:right;"> 25 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 450 </td>
   <td style="text-align:left;"> Light </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 350 </td>
   <td style="text-align:right;"> 25 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 15.0 </td>
   <td style="text-align:right;"> 1.75 </td>
   <td style="text-align:right;"> 8.57 </td>
   <td style="text-align:right;"> 30.0 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 15.0 </td>
   <td style="text-align:right;"> 1.75 </td>
   <td style="text-align:right;"> 8.57 </td>
   <td style="text-align:right;"> 30.0 </td>
   <td style="text-align:right;"> 8.571429 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Hippogryph Rider </td>
   <td style="text-align:right;"> 3.862500 </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 765 </td>
   <td style="text-align:left;"> Light </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 350 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 17.0 </td>
   <td style="text-align:right;"> 1.10 </td>
   <td style="text-align:right;"> 15.45 </td>
   <td style="text-align:right;"> 40.0 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 17.0 </td>
   <td style="text-align:right;"> 1.10 </td>
   <td style="text-align:right;"> 15.45 </td>
   <td style="text-align:right;"> 10.0 </td>
   <td style="text-align:right;"> 15.454546 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Chimaera </td>
   <td style="text-align:right;"> 6.000000 </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 330 </td>
   <td style="text-align:right;"> 70 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 1000 </td>
   <td style="text-align:left;"> Light </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 250 </td>
   <td style="text-align:right;"> 65 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 75.0 </td>
   <td style="text-align:right;"> 2.50 </td>
   <td style="text-align:right;"> 30.00 </td>
   <td style="text-align:right;"> 45.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 30.000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Chimaera 2 </td>
   <td style="text-align:right;"> 4.000000 </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 330 </td>
   <td style="text-align:right;"> 70 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 1000 </td>
   <td style="text-align:left;"> Light </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 250 </td>
   <td style="text-align:right;"> 65 </td>
   <td style="text-align:left;"> Siege </td>
   <td style="text-align:right;"> 50.0 </td>
   <td style="text-align:right;"> 2.50 </td>
   <td style="text-align:right;"> 20.00 </td>
   <td style="text-align:right;"> 85.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 20.000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Treant </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 300 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 16.0 </td>
   <td style="text-align:right;"> 1.75 </td>
   <td style="text-align:right;"> 9.14 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 9.142857 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Avatar of Vengeance </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 1200 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> 320 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 30.5 </td>
   <td style="text-align:right;"> 1.35 </td>
   <td style="text-align:right;"> 22.59 </td>
   <td style="text-align:right;"> 45.0 </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 30.5 </td>
   <td style="text-align:right;"> 1.35 </td>
   <td style="text-align:right;"> 22.59 </td>
   <td style="text-align:right;"> 45.0 </td>
   <td style="text-align:right;"> 22.592593 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Spirit of Vengeance </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 500 </td>
   <td style="text-align:left;"> Invulnerable </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 16.0 </td>
   <td style="text-align:right;"> 1.35 </td>
   <td style="text-align:right;"> 11.85 </td>
   <td style="text-align:right;"> 45.0 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 16.0 </td>
   <td style="text-align:right;"> 1.35 </td>
   <td style="text-align:right;"> 11.85 </td>
   <td style="text-align:right;"> 45.0 </td>
   <td style="text-align:right;"> 11.851852 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Acolyte </td>
   <td style="text-align:right;"> 3.800000 </td>
   <td style="text-align:left;"> Undead </td>
   <td style="text-align:right;"> 75 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:left;"> Medium </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 80 </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:right;"> 15 </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 9.5 </td>
   <td style="text-align:right;"> 2.50 </td>
   <td style="text-align:right;"> 3.80 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 3.800000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Ghoul </td>
   <td style="text-align:right;"> 5.000000 </td>
   <td style="text-align:left;"> Undead </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 340 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 18 </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 13.0 </td>
   <td style="text-align:right;"> 1.30 </td>
   <td style="text-align:right;"> 10.00 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 10.000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Crypt Fiend </td>
   <td style="text-align:right;"> 4.750000 </td>
   <td style="text-align:left;"> Undead </td>
   <td style="text-align:right;"> 215 </td>
   <td style="text-align:right;"> 40 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 550 </td>
   <td style="text-align:left;"> Medium </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 28.5 </td>
   <td style="text-align:right;"> 2.00 </td>
   <td style="text-align:right;"> 14.25 </td>
   <td style="text-align:right;"> 55.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 14.250000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Gargoyle </td>
   <td style="text-align:right;"> 4.430000 </td>
   <td style="text-align:left;"> Undead </td>
   <td style="text-align:right;"> 185 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 410 </td>
   <td style="text-align:left;"> Unarmored </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 350 </td>
   <td style="text-align:right;"> 35 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 19.5 </td>
   <td style="text-align:right;"> 2.20 </td>
   <td style="text-align:right;"> 8.86 </td>
   <td style="text-align:right;"> 30.0 </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 65.5 </td>
   <td style="text-align:right;"> 1.40 </td>
   <td style="text-align:right;"> 46.79 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:right;"> 8.863636 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Abomination </td>
   <td style="text-align:right;"> 4.737500 </td>
   <td style="text-align:left;"> Undead </td>
   <td style="text-align:right;"> 240 </td>
   <td style="text-align:right;"> 70 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 1175 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 40 </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 36.0 </td>
   <td style="text-align:right;"> 1.90 </td>
   <td style="text-align:right;"> 18.95 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 18.947368 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Meat Wagon </td>
   <td style="text-align:right;"> 4.970000 </td>
   <td style="text-align:left;"> Undead </td>
   <td style="text-align:right;"> 230 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 380 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:right;"> 45 </td>
   <td style="text-align:left;"> Siege </td>
   <td style="text-align:right;"> 79.5 </td>
   <td style="text-align:right;"> 4.00 </td>
   <td style="text-align:right;"> 19.88 </td>
   <td style="text-align:right;"> 115.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 19.875000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Necromancer </td>
   <td style="text-align:right;"> 2.360000 </td>
   <td style="text-align:left;"> Undead </td>
   <td style="text-align:right;"> 145 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 305 </td>
   <td style="text-align:left;"> Unarmored </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 24 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 8.5 </td>
   <td style="text-align:right;"> 1.80 </td>
   <td style="text-align:right;"> 4.72 </td>
   <td style="text-align:right;"> 60.0 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 8.5 </td>
   <td style="text-align:right;"> 1.80 </td>
   <td style="text-align:right;"> 4.72 </td>
   <td style="text-align:right;"> 60.0 </td>
   <td style="text-align:right;"> 4.722222 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Banshee </td>
   <td style="text-align:right;"> 3.665000 </td>
   <td style="text-align:left;"> Undead </td>
   <td style="text-align:right;"> 155 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 285 </td>
   <td style="text-align:left;"> Unarmored </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 28 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 11.0 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 7.33 </td>
   <td style="text-align:right;"> 60.0 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 11.0 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 7.33 </td>
   <td style="text-align:right;"> 60.0 </td>
   <td style="text-align:right;"> 7.333333 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Frost Wyrm </td>
   <td style="text-align:right;"> 4.952857 </td>
   <td style="text-align:left;"> Undead </td>
   <td style="text-align:right;"> 385 </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 1350 </td>
   <td style="text-align:left;"> Light </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 65 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 104.0 </td>
   <td style="text-align:right;"> 3.00 </td>
   <td style="text-align:right;"> 34.67 </td>
   <td style="text-align:right;"> 30.0 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 89.0 </td>
   <td style="text-align:right;"> 3.00 </td>
   <td style="text-align:right;"> 29.67 </td>
   <td style="text-align:right;"> 30.0 </td>
   <td style="text-align:right;"> 34.666667 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Shade </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Undead </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 125 </td>
   <td style="text-align:left;"> Medium </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 190 </td>
   <td style="text-align:right;"> 350 </td>
   <td style="text-align:right;"> 15 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Skeleton Warrior </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:left;"> Undead </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 180 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 80 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 14.5 </td>
   <td style="text-align:right;"> 2.00 </td>
   <td style="text-align:right;"> 7.25 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 7.250000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Skeletal Mage </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:left;"> Undead </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 230 </td>
   <td style="text-align:left;"> Medium </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 11.5 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 7.67 </td>
   <td style="text-align:right;"> 50.0 </td>
   <td style="text-align:left;"> Pierce </td>
   <td style="text-align:right;"> 11.5 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 7.67 </td>
   <td style="text-align:right;"> 50.0 </td>
   <td style="text-align:right;"> 7.666667 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Infernal </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Undead </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 1500 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 320 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Chaos </td>
   <td style="text-align:right;"> 54.5 </td>
   <td style="text-align:right;"> 1.35 </td>
   <td style="text-align:right;"> 40.37 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 40.370370 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Carrion Beetle 1 </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:left;"> Undead </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 8.5 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 5.67 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 5.666667 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Carrion Beetle 2 </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:left;"> Undead </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 275 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 16.5 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 11.00 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 11.000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Carrion Beetle 3 </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:left;"> Undead </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 410 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Normal </td>
   <td style="text-align:right;"> 24.5 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 16.33 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 16.333333 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Obsidian Statue </td>
   <td style="text-align:right;"> 1.190000 </td>
   <td style="text-align:left;"> Undead </td>
   <td style="text-align:right;"> 200 </td>
   <td style="text-align:right;"> 35 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 550 </td>
   <td style="text-align:left;"> Heavy </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 45 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 7.5 </td>
   <td style="text-align:right;"> 2.10 </td>
   <td style="text-align:right;"> 3.57 </td>
   <td style="text-align:right;"> 57.5 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 7.5 </td>
   <td style="text-align:right;"> 2.10 </td>
   <td style="text-align:right;"> 3.57 </td>
   <td style="text-align:right;"> 57.5 </td>
   <td style="text-align:right;"> 3.571429 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Destroyer </td>
   <td style="text-align:right;"> 2.962000 </td>
   <td style="text-align:left;"> Undead </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 900 </td>
   <td style="text-align:left;"> Light </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> 320 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 20.0 </td>
   <td style="text-align:right;"> 1.35 </td>
   <td style="text-align:right;"> 14.81 </td>
   <td style="text-align:right;"> 45.0 </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 20.0 </td>
   <td style="text-align:right;"> 1.35 </td>
   <td style="text-align:right;"> 14.81 </td>
   <td style="text-align:right;"> 45.0 </td>
   <td style="text-align:right;"> 14.814815 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="mutate-с-условием" class="slide level2">
<h2><code>mutate()</code> с условием</h2>
<p>Часто нужно заполнить новую колонку определенными значениями в зависимости от условия.</p>
<p>Допустим, мы хотим разделить юнитов по принципу, являются ли они призванными (число пищи <code>pop</code> равно <code>0</code> или <code>NA</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>) <span class="co"># для воспроизводимости семплирования 5 строчек</span></span>
<span id="cb50-2"><a href="#cb50-2"></a>wc3_units_summon <span class="ot">&lt;-</span> wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb50-3"><a href="#cb50-3"></a>  <span class="fu">mutate</span>(<span class="at">is_summon =</span> (pop <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|</span> <span class="fu">is.na</span>(pop)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-4"><a href="#cb50-4"></a>  <span class="fu">select</span>(unit, race, pop, is_summon) <span class="sc">%&gt;%</span> <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">

<table class="table table-striped" style="font-size: 28px; width: auto !important; ">
 <thead>
  <tr>
   <th style="text-align:left;"> unit </th>
   <th style="text-align:left;"> race </th>
   <th style="text-align:right;"> pop </th>
   <th style="text-align:left;"> is_summon </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Carrion Beetle 2 </td>
   <td style="text-align:left;"> Undead </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> TRUE </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Dryad </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:left;"> FALSE </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Peasant </td>
   <td style="text-align:left;"> Human </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> FALSE </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Serpent Ward </td>
   <td style="text-align:left;"> Orc </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> TRUE </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Mountain Giant 2 </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:left;"> FALSE </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="mutate-с-условием-для-существующей-колонки" class="slide level2">
<h2><code>mutate()</code> с условием для существующей колонки</h2>
<p>Например, мы хотим переименовать N.Elf в NightElfes. Для этого пригодится функция <code>str_replace()</code> из библиотеки <code>stringr</code>, которая является аналогом базовой функции <code>gsub()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb51-2"><a href="#cb51-2"></a>  <span class="fu">mutate</span>(<span class="at">race =</span> <span class="fu">str_replace</span>(race, <span class="st">'N.Elf'</span>, <span class="st">'NightElfes'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb51-3"><a href="#cb51-3"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">8</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb51-4"><a href="#cb51-4"></a>  <span class="fu">select</span>(unit<span class="sc">:</span>pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
  unit              race        gold  wood   pop
  &lt;chr&gt;             &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Water Elemental 1 Human         NA    NA    NA
2 Meat Wagon        Undead       230    50     4
3 Treant            NightElfes    NA    NA    NA
4 T. Berserker      Orc          135    20     2
5 Acolyte           Undead        75     0     1
6 Sorceress         Human        155    20     2
7 Huntress          NightElfes   195    20     3
8 DoC Bear Form     NightElfes    NA    NA     4</code></pre>
</div>
</div>
</section>
<section id="mutate-if_else" class="slide level2">
<h2><code>mutate()</code> + <code>if_else()</code></h2>
<p>В качестве примера <code>if_else()</code> проверка, является ли число положительным или отрицательным. Вспомним материал второй лекции.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>number <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb53-2"><a href="#cb53-2"></a><span class="fu">if_else</span>(number <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">'Положительное число'</span>, </span>
<span id="cb53-3"><a href="#cb53-3"></a>        <span class="st">'Отрицательное число или ноль'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Отрицательное число или ноль" "Отрицательное число или ноль"
[3] "Отрицательное число или ноль" "Положительное число"         
[5] "Положительное число"         </code></pre>
</div>
</div>
<p>Синтаксис <code>if_else</code>: <code>(&lt;условие&gt;, выражение если TRUE, выражение если FALSE)</code>.</p>
<div class="callout callout-note callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>Функция <code>if()</code> в R является невекторизованной, то есть с помощью <code>if()</code> можно сравнивать только одно значение, а не целый вектор.</p>
</div>
</div>
</div>
</section>
<section id="mutate-if_else-1" class="slide level2">
<h2><code>mutate()</code> + <code>if_else()</code></h2>
<p>Попробуем создать колонку, заполненную значениями, являются ли юниты призванными (до этого мы просто заполнили <code>TRUE</code>, <code>FALSE</code>, теперь хотим заполнить текстовым описанием).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>wc3_units_summon_ifelse <span class="ot">&lt;-</span> wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb55-2"><a href="#cb55-2"></a>  <span class="fu">mutate</span>(<span class="at">if_summon =</span> <span class="fu">if_else</span>((pop <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|</span> <span class="fu">is.na</span>(pop), </span>
<span id="cb55-3"><a href="#cb55-3"></a>                            <span class="st">'Призванные'</span>, <span class="st">'Непризванные'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table>
 <thead>
  <tr>
   <th style="text-align:left;"> unit </th>
   <th style="text-align:left;"> race </th>
   <th style="text-align:right;"> pop </th>
   <th style="text-align:left;"> if_summon </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Huntress </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:left;"> Непризванные </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Serpent Ward </td>
   <td style="text-align:left;"> Orc </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Призванные </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Hippogryph </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> Непризванные </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Shadow Wolf </td>
   <td style="text-align:left;"> Orc </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:left;"> Призванные </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Wisp </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Непризванные </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="mutate-с-условием-case_when" class="slide level2">
<h2><code>mutate()</code> с условием + <code>case_when()</code></h2>
<p>Если нужно использовать более чем 1 условие, то рекомендую воспользоваться функцией <code>case_when()</code> из библиотеки <code>dplyr</code>.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb56-2"><a href="#cb56-2"></a>  number <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"Положительное число"</span>,</span>
<span id="cb56-3"><a href="#cb56-3"></a>  number <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"Отрицательное число"</span>,</span>
<span id="cb56-4"><a href="#cb56-4"></a>  number <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"Ноль"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Отрицательное число" "Отрицательное число" "Ноль"               
[4] "Положительное число" "Положительное число"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>number</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3 -1  0  2  5</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="fu">case_when</span>(</span>
<span id="cb60-2"><a href="#cb60-2"></a>  number <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"Положительное число"</span>,</span>
<span id="cb60-3"><a href="#cb60-3"></a>  number <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"Отрицательное число"</span>,</span>
<span id="cb60-4"><a href="#cb60-4"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Ноль"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Отрицательное число" "Отрицательное число" "Ноль"               
[4] "Положительное число" "Положительное число"</code></pre>
</div>
</div>
</div>
</div>
<p>Можно задать дефолтное значение для не попадающих ни под одно условие с помощью формулы: <code>TRUE ~ &lt;значение&gt;</code>.</p>
</section>
<section id="mutate-с-условием-case_when-1" class="slide level2">
<h2><code>mutate</code> с условием + <code>case_when</code></h2>
<p>Пример с <code>mutate()</code> + <code>case_when()</code> для разделения юнитов на группы по количеству здоровья (<code>hp</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb62-2"><a href="#cb62-2"></a>  <span class="fu">mutate</span>(<span class="at">hp_rate =</span> <span class="fu">case_when</span>(hp <span class="sc">&gt;</span> <span class="dv">1000</span> <span class="sc">~</span> <span class="st">"The most healthy units"</span>,</span>
<span id="cb62-3"><a href="#cb62-3"></a>  hp <span class="sc">&gt;</span> <span class="dv">500</span> <span class="sc">~</span> <span class="st">"Middle helthy units"</span>,</span>
<span id="cb62-4"><a href="#cb62-4"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"The weakest"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-5"><a href="#cb62-5"></a>  <span class="fu">relocate</span>(hp_rate, <span class="at">.after =</span> hp) <span class="sc">%&gt;%</span> <span class="co"># для перемещения колонки после hp</span></span>
<span id="cb62-6"><a href="#cb62-6"></a>  <span class="fu">select</span>(unit<span class="sc">:</span>hp_rate) <span class="sc">%&gt;%</span> </span>
<span id="cb62-7"><a href="#cb62-7"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  unit             race    gold  wood   pop    hp hp_rate               
  &lt;chr&gt;            &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;                 
1 Obsidian Statue  Undead   200    35     3   550 Middle helthy units   
2 Mountain Giant   N.Elf    425   100     7  1600 The most healthy units
3 Glaive Thrower   N.Elf    210    65     3   300 The weakest           
4 T. Headhunter    Orc      135    20     2   350 The weakest           
5 Kodo Beast       Orc      255    60     4  1000 Middle helthy units   
6 Carrion Beetle 2 Undead    NA    NA     0   275 The weakest           </code></pre>
</div>
</div>
</section></section>
<section>
<section id="подсчет-суммарных-статистик" class="title-slide slide level1 center">
<h1>Подсчет суммарных статистик</h1>

</section>
<section id="group_by-summarise-связка" class="slide level2">
<h2><code>group_by()</code> + <code>summarise()</code> связка</h2>
<p>Это очень мощная связка, удобных аналогов которой нет в base R.</p>
<p>Попробуем посчитать медиану урона (<code>damage</code>) для каждой расы.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb64-2"><a href="#cb64-2"></a>  <span class="fu">group_by</span>(race) <span class="sc">%&gt;%</span> </span>
<span id="cb64-3"><a href="#cb64-3"></a>  <span class="fu">summarise</span>(<span class="at">median_damage =</span> <span class="fu">median</span>(damage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  race   median_damage
  &lt;chr&gt;          &lt;dbl&gt;
1 Human           20  
2 N.Elf           19.2
3 Orc             19.5
4 Undead          16.5</code></pre>
</div>
</div>
</section>
<section id="group_by-summarise-связка-1" class="slide level2">
<h2><code>group_by()</code> + <code>summarise()</code> связка</h2>
<p>Можно сразу собирать несколько статистик:</p>
<div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb66-2"><a href="#cb66-2"></a>  <span class="fu">group_by</span>(race) <span class="sc">%&gt;%</span> </span>
<span id="cb66-3"><a href="#cb66-3"></a>  <span class="fu">summarise</span>(<span class="at">mean_damage =</span> <span class="fu">mean</span>(damage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb66-4"><a href="#cb66-4"></a>            <span class="at">mean_hp =</span> <span class="fu">mean</span>(hp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code># A tibble: 4 × 3
  race   mean_damage mean_hp
  &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;
1 Human         27.7    556.
2 N.Elf         28.8    649.
3 Orc           22.9    483.
4 Undead        27.5    518.</code></pre>
</div>
</div>
</div>
</div>
</section>
<section class="slide level2">

<p>Иллюстрация что происходит с таблицей при использовании <code>group_by()</code> + <code>summarise()</code></p>

<img data-src="https://moderndive.github.io/moderndive_labs/static/previous_versions/v0.4.0/images/group_summary.png" alt="Data Wrangling with dplyr and tidyr" class="r-stretch quarto-figure-center"><p class="caption">Data Wrangling with dplyr and tidyr</p></section>
<section id="across-summarise---для-быстрого-вычисления-описательных-статистик" class="slide level2">
<h2><code>across()</code> + <code>summarise()</code> - для быстрого вычисления описательных статистик</h2>
<p>Например, задача посчитать медиану для всех числовых переменных в датасете <code>wc3_units</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>wc3_units_summon <span class="sc">%&gt;%</span></span>
<span id="cb68-2"><a href="#cb68-2"></a>  <span class="fu">filter</span>(<span class="sc">!</span>is_summon) <span class="sc">%&gt;%</span> <span class="co"># чтобы анализировать только не-призванных юнитов</span></span>
<span id="cb68-3"><a href="#cb68-3"></a>  <span class="fu">group_by</span>(race) <span class="sc">%&gt;%</span> </span>
<span id="cb68-4"><a href="#cb68-4"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), </span>
<span id="cb68-5"><a href="#cb68-5"></a>                   <span class="cf">function</span>(x) <span class="fu">median</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 18
  race    gold  wood   pop    hp armor sight speed  time damage cooldown   dps
  &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;
1 Human   188.  30     3    420    1     140   270    28   14       1.9   10.4
2 N.Elf   195   60     3    488.   1     140   270    35   20.5     1.78  13.6
3 Orc     180   35     3    450    0     140   270    30   19.5     1.9   11.1
4 Undead  192.  32.5   2.5  395    0.5   140   270    30   19.5     2     10  
# … with 6 more variables: range &lt;dbl&gt;, damage_2 &lt;dbl&gt;, cooldown_2 &lt;dbl&gt;,
#   dps_2 &lt;dbl&gt;, range_2 &lt;dbl&gt;, damage_per_second &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="across-summarise---для-быстрого-вычисления-описательных-статистик-1" class="slide level2" style="font-size: 90%">
<h2><code>across()</code> + <code>summarise()</code> - для быстрого вычисления описательных статистик</h2>
<p>Или пример попроще: посчитать среднее и стандартное отклонение в датасете <code>iris</code> (можно без группировки по видам <code>Species</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>iris <span class="sc">%&gt;%</span> </span>
<span id="cb70-2"><a href="#cb70-2"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), </span>
<span id="cb70-3"><a href="#cb70-3"></a>                   <span class="fu">list</span>(<span class="at">mean =</span> mean, <span class="at">sd =</span> sd)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length_mean Sepal.Length_sd Sepal.Width_mean Sepal.Width_sd
1          5.843333       0.8280661         3.057333      0.4358663
  Petal.Length_mean Petal.Length_sd Petal.Width_mean Petal.Width_sd
1             3.758        1.765298         1.199333      0.7622377</code></pre>
</div>
</div>
<p>На самом деле здесь я бы скорее перевела данные в long format и потом уже считала статистики, но идея должна быть понятна.</p>
<div class="callout callout-note callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>Синтаксис <code>across()</code> похож на функции семейства <code>apply()</code> и <code>map_*()</code>. Сначала пишем, для каких колонок провести функцию, и далее саму функцию - встроенную, анонимную или созданную пользователем.</p>
</div>
</div>
</div>
</section>
<section id="across-mutate" class="slide level2" style="font-size: 90%">
<h2><code>across()</code> + <code>mutate()</code></h2>
<p>Это очень актуальная вещь при работе с транскриптомными данными. Например, заменить <code>logFC</code>, которые не <code>NA</code> и не ноль на 1. Создадим пример таблицы:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>gene_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> <span class="fu">paste0</span>(<span class="st">'gene'</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>), </span>
<span id="cb72-2"><a href="#cb72-2"></a>                     <span class="at">logFC_df1 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">runif</span>(<span class="dv">6</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">max =</span> <span class="dv">5</span>), <span class="cn">NA</span>), <span class="dv">8</span>),</span>
<span id="cb72-3"><a href="#cb72-3"></a>                     <span class="at">FDR_df1 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="fu">runif</span>(<span class="dv">6</span>, <span class="dv">10</span><span class="sc">^-</span><span class="dv">50</span>, <span class="dv">1</span>), <span class="fl">0.01</span>, <span class="fl">0.0005</span>), <span class="dv">8</span>),</span>
<span id="cb72-4"><a href="#cb72-4"></a>                     <span class="at">logFC_df2 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">runif</span>(<span class="dv">6</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">max =</span> <span class="dv">5</span>), <span class="cn">NA</span>), <span class="dv">8</span>),</span>
<span id="cb72-5"><a href="#cb72-5"></a>                     <span class="at">FDR_df2 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="fu">runif</span>(<span class="dv">6</span>, <span class="dv">10</span><span class="sc">^-</span><span class="dv">50</span>, <span class="dv">1</span>), <span class="fl">0.001</span>, <span class="fl">0.03</span>), <span class="dv">8</span>))</span>
<span id="cb72-6"><a href="#cb72-6"></a>gene_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
  id    logFC_df1 FDR_df1 logFC_df2 FDR_df2
  &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 gene1    NA      0.0842     2.77   0.779 
2 gene2     2.32   0.0005     0      0.455 
3 gene3     0      0.01       4.61   0.797 
4 gene4    -4.77   0.332     -0.653  0.03  
5 gene5    -0.228  0.258      2.13   0.001 
6 gene6     3.61   0.479     -1.00   0.0589
7 gene7     1.93   0.651     -1.10   0.876 
8 gene8    -0.224  0.766     NA      0.642 </code></pre>
</div>
</div>
</section>
<section id="across-mutate-1" class="slide level2 smaller">
<h2><code>across()</code> + <code>mutate()</code></h2>
<p>Теперь заменим:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>gene_table <span class="sc">%&gt;%</span> </span>
<span id="cb74-2"><a href="#cb74-2"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">'logFC'</span>), </span>
<span id="cb74-3"><a href="#cb74-3"></a>                <span class="cf">function</span>(x) <span class="fu">if_else</span>(x <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span> <span class="fu">is.na</span>(x), <span class="dv">0</span>, <span class="dv">1</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
  id    logFC_df1 FDR_df1 logFC_df2 FDR_df2
  &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 gene1         0  0.0842         1  0.779 
2 gene2         1  0.0005         0  0.455 
3 gene3         0  0.01           1  0.797 
4 gene4         1  0.332          1  0.03  
5 gene5         1  0.258          1  0.001 
6 gene6         1  0.479          1  0.0589
7 gene7         1  0.651          1  0.876 
8 gene8         1  0.766          0  0.642 </code></pre>
</div>
</div>
<p>Еще нередко возникает задача например занулить все незначимые по <code>FDR</code> значения <code>logFC</code> для каждого датасета, но это лучше сделать, используя перевод данных из широкого в длинный формат и обратно.</p>
</section>
<section id="arrange---сортировка" class="slide level2">
<h2><code>arrange()</code> - сортировка</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>n_elf_dm40 <span class="ot">&lt;-</span>  wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb76-2"><a href="#cb76-2"></a>  <span class="fu">filter</span>(race <span class="sc">==</span> <span class="st">'N.Elf'</span> <span class="sc">&amp;</span> damage <span class="sc">&gt;</span> <span class="dv">40</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-3"><a href="#cb76-3"></a>  <span class="fu">select</span>(unit<span class="sc">:</span>race, ground_attack<span class="sc">:</span>damage) <span class="sc">%&gt;%</span> </span>
<span id="cb76-4"><a href="#cb76-4"></a>  <span class="fu">arrange</span>(damage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table>
 <thead>
  <tr>
   <th style="text-align:left;"> unit </th>
   <th style="text-align:left;"> race </th>
   <th style="text-align:left;"> ground_attack </th>
   <th style="text-align:right;"> damage </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Mountain Giant 2 </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:left;"> Siege </td>
   <td style="text-align:right;"> 41.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Glaive Thrower </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:left;"> Siege </td>
   <td style="text-align:right;"> 44.5 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Chimaera 2 </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:left;"> Siege </td>
   <td style="text-align:right;"> 50.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Chimaera </td>
   <td style="text-align:left;"> N.Elf </td>
   <td style="text-align:left;"> Magic </td>
   <td style="text-align:right;"> 75.0 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p><code>desc()</code> - для сортировки по убыванию.</p>
<p>Как думаете, есть ли преимущество относительно базовой функции <code>order()</code> или <code>sort()</code>, в которой есть параметр <code>decreasing = TRUE</code>?</p>
</section>
<section id="сортировка-по-нескольким-колонкам" class="slide level2">
<h2>Сортировка по нескольким колонкам</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a>wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb77-2"><a href="#cb77-2"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(damage), <span class="fu">desc</span>(hp), unit) <span class="sc">%&gt;%</span> </span>
<span id="cb77-3"><a href="#cb77-3"></a>  <span class="fu">select</span>(unit<span class="sc">:</span>hp, damage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 71 × 7
   unit          race    gold  wood   pop    hp damage
   &lt;chr&gt;         &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 Frost Wyrm    Undead   385   120     7  1350  104  
 2 Demolisher    Orc      220    50     4   425   80.5
 3 Meat Wagon    Undead   230    50     4   380   79.5
 4 Chimaera      N.Elf    330    70     5  1000   75  
 5 Phoenix       Human     NA    NA    NA  1250   68  
 6 Mortar Team   Human    180    70     3   360   58  
 7 Infernal      Undead    NA    NA    NA  1500   54.5
 8 Chimaera 2    N.Elf    330    70     5  1000   50  
 9 Gryphon Rider Human    280    70     4   825   50  
10 Siege Engine  Human    195    60     3   700   50  
# … with 61 more rows</code></pre>
</div>
</div>
</section>
<section id="другие-функции-count" class="slide level2">
<h2>Другие функции: <code>count()</code></h2>
<p><code>count()</code> - для удобного подсчета количества элементов по категориям. Можно выводить по нескольким категориям сразу</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb79-2"><a href="#cb79-2"></a>  <span class="fu">count</span>(race)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  race       n
  &lt;chr&gt;  &lt;int&gt;
1 Human     17
2 N.Elf     19
3 Orc       17
4 Undead    18</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a>wc3_units <span class="sc">%&gt;%</span> </span>
<span id="cb81-2"><a href="#cb81-2"></a>  <span class="fu">count</span>(race, ground_attack)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 19 × 3
   race   ground_attack     n
   &lt;chr&gt;  &lt;chr&gt;         &lt;int&gt;
 1 Human  Magic             4
 2 Human  Normal            5
 3 Human  Pierce            5
 4 Human  Siege             3
 5 N.Elf  Magic             3
 6 N.Elf  Normal            6
 7 N.Elf  Pierce            5
 8 N.Elf  Siege             3
 9 N.Elf  &lt;NA&gt;              2
10 Orc    Magic             3
11 Orc    Normal            6
12 Orc    Pierce            5
13 Orc    Siege             3
14 Undead Chaos             1
15 Undead Magic             5
16 Undead Normal            7
17 Undead Pierce            3
18 Undead Siege             1
19 Undead &lt;NA&gt;              1</code></pre>
</div>
</div>
</div>
</div>
<p>Как думаете, для чего это может быть полезно?</p>
</section>
<section id="широкий-и-длинный-формат-данных" class="slide level2">
<h2>Широкий и длинный формат данных</h2>
<p>Данные в широком формате</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="fu">head</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa</code></pre>
</div>
</div>
<p>Данные в длинном формате:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  id    Species name         value
  &lt;chr&gt; &lt;fct&gt;   &lt;chr&gt;        &lt;dbl&gt;
1 1     setosa  Sepal.Length   5.1
2 1     setosa  Sepal.Width    3.5
3 1     setosa  Petal.Length   1.4
4 1     setosa  Petal.Width    0.2
5 2     setosa  Sepal.Length   4.9</code></pre>
</div>
</div>
</section>
<section id="pivot_longer-pivot_wider---конвертация-таблиц" class="slide level2" style="font-size: 90%">
<h2><code>pivot_longer()</code> / <code>pivot_wider()</code> - конвертация таблиц</h2>
<p>Это функции из пакета <code>tidyr</code> для перевода датафрейма в длинный или широкий формат.</p>
<p>В простейшем случае синтаксис pivot_longer: <code>cols</code> = колонки, которые необходимо трансформировать. Можно добавить параметры <code>names_to</code> и <code>values_to</code>, которые добавят имена вновь возданным колонкам.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a>iris_long <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span> </span>
<span id="cb86-2"><a href="#cb86-2"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">'id'</span>) <span class="sc">%&gt;%</span> <span class="co"># чтобы создать переменную id из номеров колонок</span></span>
<span id="cb86-3"><a href="#cb86-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> Sepal.Length<span class="sc">:</span>Petal.Width)</span>
<span id="cb86-4"><a href="#cb86-4"></a>iris_long</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 600 × 4
   id    Species name         value
   &lt;chr&gt; &lt;fct&gt;   &lt;chr&gt;        &lt;dbl&gt;
 1 1     setosa  Sepal.Length   5.1
 2 1     setosa  Sepal.Width    3.5
 3 1     setosa  Petal.Length   1.4
 4 1     setosa  Petal.Width    0.2
 5 2     setosa  Sepal.Length   4.9
 6 2     setosa  Sepal.Width    3  
 7 2     setosa  Petal.Length   1.4
 8 2     setosa  Petal.Width    0.2
 9 3     setosa  Sepal.Length   4.7
10 3     setosa  Sepal.Width    3.2
# … with 590 more rows</code></pre>
</div>
</div>
</section>
<section id="pivot_longer" class="slide level2">
<h2><code>pivot_longer()</code></h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="figures/sandwich_pivot.PNG" width="1500"></p>
</div><div class="column" style="width:50%;">
<p>Для выбора колонок можно использовать концепт <code>tidy-select</code>-а.</p>
<p>Лучше всего еще перед трансформацией создать колонку с id каждого наблюдения.</p>
<p>Длинный формат более удобен для проведения дисперсионного анализа, построения графиков.</p>
</div>
</div>
</section>
<section id="pivot_wider" class="slide level2">
<h2><code>pivot_wider()</code></h2>
<p>Нередко нужно вернуть обратно таблицу в широкий формат</p>
<p>Например так:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a>iris_long <span class="sc">%&gt;%</span> </span>
<span id="cb88-2"><a href="#cb88-2"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(id, Species), </span>
<span id="cb88-3"><a href="#cb88-3"></a>              <span class="at">names_from =</span> name, <span class="at">values_from =</span> value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 150 × 6
   id    Species Sepal.Length Sepal.Width Petal.Length Petal.Width
   &lt;chr&gt; &lt;fct&gt;          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
 1 1     setosa           5.1         3.5          1.4         0.2
 2 2     setosa           4.9         3            1.4         0.2
 3 3     setosa           4.7         3.2          1.3         0.2
 4 4     setosa           4.6         3.1          1.5         0.2
 5 5     setosa           5           3.6          1.4         0.2
 6 6     setosa           5.4         3.9          1.7         0.4
 7 7     setosa           4.6         3.4          1.4         0.3
 8 8     setosa           5           3.4          1.5         0.2
 9 9     setosa           4.4         2.9          1.4         0.2
10 10    setosa           4.9         3.1          1.5         0.1
# … with 140 more rows</code></pre>
</div>
</div>
</section>
<section id="теперь-как-занулить-все-незначимые-фолды" class="slide level2">
<h2>Теперь как занулить все незначимые фолды</h2>
<p>Вернемся к таблице gene_table. Задача превратить в ноль все фолды, для которых <code>FDR &gt; 0.05</code>. Используем сразу несколько подходов к манипуляции с таблицами.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a>gene_table <span class="sc">%&gt;%</span> </span>
<span id="cb90-2"><a href="#cb90-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">where</span>(is.numeric), <span class="at">names_pattern =</span> <span class="st">"(.*)_(.*)"</span>,</span>
<span id="cb90-3"><a href="#cb90-3"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">'.value'</span>, <span class="st">'dataset'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb90-4"><a href="#cb90-4"></a>  <span class="fu">mutate</span>(<span class="at">logFC =</span> <span class="fu">if_else</span>(FDR <span class="sc">&lt;</span> <span class="fl">0.05</span>, logFC, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb90-5"><a href="#cb90-5"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> id, <span class="at">names_from =</span> dataset, </span>
<span id="cb90-6"><a href="#cb90-6"></a>              <span class="at">values_from =</span> <span class="fu">c</span>(logFC, FDR), <span class="at">names_vary =</span> <span class="st">'slowest'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
  id    logFC_df1 FDR_df1 logFC_df2 FDR_df2
  &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 gene1      0     0.0842     0      0.779 
2 gene2      2.32  0.0005     0      0.455 
3 gene3      0     0.01       0      0.797 
4 gene4      0     0.332     -0.653  0.03  
5 gene5      0     0.258      2.13   0.001 
6 gene6      0     0.479      0      0.0589
7 gene7      0     0.651      0      0.876 
8 gene8      0     0.766      0      0.642 </code></pre>
</div>
</div>
</section>
<section id="join---для-объединения-таблиц" class="slide level2">
<h2><code>join()</code> - для объединения таблиц</h2>
<p>Часто необходим для объединения сходных табличек.</p>
<ul>
<li><p><code>inner_join()</code> - объединяет только общие строки в обеих таблицах;</p></li>
<li><p><code>full_join()</code> - объединяет все строки в обеих таблицах;</p></li>
<li><p><code>left_join()</code> - все строки из первой таблицы и те строки из второй, которые есть в первой;</p></li>
<li><p><code>right_join()</code> - принцип как у <code>left_join</code>, только наоборот (используется редко).</p></li>
</ul>

<img data-src="https://d33wubrfki0l68.cloudfront.net/aeab386461820b029b7e7606ccff1286f623bae1/ef0d4/diagrams/join-venn.png" class="r-stretch"></section>
<section id="join---пример" class="slide level2 smaller">
<h2><code>join()</code> - пример</h2>
<p>Например, нужно объединить результаты анализа дифференциальной экспрессии данных микрочипов и RNA-seq.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> <span class="fu">paste0</span>(<span class="st">'gene'</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>), <span class="at">logFC_df1 =</span> <span class="fu">runif</span>(<span class="dv">6</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>),</span>
<span id="cb92-2"><a href="#cb92-2"></a>              <span class="at">FDR_df1 =</span> <span class="fu">runif</span>(<span class="dv">6</span>, <span class="fl">0.000001</span>, <span class="dv">1</span>))</span>
<span id="cb92-3"><a href="#cb92-3"></a>df2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> <span class="fu">paste0</span>(<span class="st">'gene'</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">8</span>), <span class="at">logFC_df2 =</span> <span class="fu">runif</span>(<span class="dv">6</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>),</span>
<span id="cb92-4"><a href="#cb92-4"></a>              <span class="at">FDR_df2 =</span> <span class="fu">runif</span>(<span class="dv">6</span>, <span class="fl">0.000001</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a>df1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  id    logFC_df1 FDR_df1
  &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 gene1    -3.71   0.357 
2 gene2    -0.219  0.431 
3 gene3     4.24   0.148 
4 gene4     0.988  0.0131
5 gene5     4.76   0.716 
6 gene6     2.32   0.103 </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a>df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  id    logFC_df2 FDR_df2
  &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 gene3   -0.537    0.755
2 gene4    1.40     0.454
3 gene5    4.92     0.511
4 gene6   -0.0441   0.208
5 gene7   -0.157    0.229
6 gene8   -3.27     0.596</code></pre>
</div>
</div>
</div>
</div>
<p>Есть общие айди генов, есть уникальные в каждом датасете. Какой вид джойна подойдет в этом случае?</p>
</section>
<section id="join---продолжение" class="slide level2">
<h2><code>join()</code> - продолжение</h2>
<p>Я обычно использую <code>full_join</code>, потому что не хочу терять какую-либо информацию о данных.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a><span class="fu">full_join</span>(df1, df2, <span class="at">by =</span> <span class="st">'id'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
  id    logFC_df1 FDR_df1 logFC_df2 FDR_df2
  &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 gene1    -3.71   0.357    NA       NA    
2 gene2    -0.219  0.431    NA       NA    
3 gene3     4.24   0.148    -0.537    0.755
4 gene4     0.988  0.0131    1.40     0.454
5 gene5     4.76   0.716     4.92     0.511
6 gene6     2.32   0.103    -0.0441   0.208
7 gene7    NA     NA        -0.157    0.229
8 gene8    NA     NA        -3.27     0.596</code></pre>
</div>
</div>
<p>Если столбцы <code>id</code>, по которым будет проходить джойн неодинаковые, можно задать например так: <code>full_join(df1, df2, by = c('gene_id' = 'id'))</code>.</p>
</section>
<section id="считывание-данных-в-формате-excel" class="slide level2">
<h2>Считывание данных в формате Excel</h2>
<p>Библиотека <code>readxl</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb99-2"><a href="#cb99-2"></a>df <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">'table.xlsx'</span>, <span class="at">sheet =</span> <span class="st">'Sheet1'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="заключение" class="slide level2" style="font-size: 90%">
<h2>Заключение</h2>
<p>Мы прошли основные функции для преобразования таблиц.</p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>Для работы с колонками:</p>
<ul>
<li><p><code>select</code> - выбрать несколько колонок и <code>pull</code>- выбрать одну колонку как вектор</p></li>
<li><p><code>mutate</code> - изменить колонку/и</p></li>
<li><p><code>across</code> в связке с <code>mutate</code> и <code>summarise</code></p></li>
<li><p><code>case_when</code> - аналог <code>if_else</code> для нескольких условий</p></li>
<li><p><code>arrange</code> - сортировка по какой-либо колонке</p></li>
<li><p><code>relocate</code> - перемещение колонки</p></li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li><p>Для работы со строками:</p>
<ul>
<li><p><code>count</code> - посчитать количество наблюдений по группам</p></li>
<li><p><code>filter</code> - выбрать строки по условию</p></li>
<li><p><code>slice</code> (выбрать строки по индексу) и его товарищи:</p>
<ul>
<li><p><code>slice_max</code>, <code>slice_min</code> отобрать наибольшие/наименьшие значения по какой-либо переменной</p></li>
<li><p><code>slice_sample</code> случайно выбрать несколько строк из датасета</p></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
</section>
<section class="slide level2">

<p>Для работы со всей таблицей целиком:</p>
<ul>
<li><p><code>group_by</code> - сгруппировать датасет</p></li>
<li><p><code>summarise</code> - что-то подсчитать по датасету</p></li>
<li><p><code>pivot_longer</code> / <code>pivot_wider</code> перевод таблицы в длинный и широкий формат</p></li>
<li><p><code>full_join</code>, <code>inner_join</code>, <code>left_join</code></p></li>
</ul>
</section>
<section id="вопросы" class="slide level2">
<h2>Вопросы?</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p>Поддержать можно <a href="https://www.tinkoff.ru/rm/ubogoeva.elena1/TSRBI31474">здесь</a>:</p>
<p><img data-src="images/qrcode.png" width="233"></p>
<p>Подписывайтесь на телеграм-канал: <a href="https://t.me/stats_for_science">Статистика и R</a></p>
<p><img data-src="images/paste-78E5F205.png" width="212"></p>
</div><div class="column" style="width:50%;">
<p>А еще мы заказывали значки и стикеры с <code>tidyverse</code> в RStudio office</p>
<p><img data-src="images/paste-078A24F8.png" width="570"></p>
</div>
</div>

<div class="footer footer-default">

</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-pointer/pointer.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'pointer': {"key":"q","color":"red","pointerSize":16,"alwaysVisible":false},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: true,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,

        height: 720,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, RevealPointer, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>